define("ebook_eleAnimation",["snabbt"],function(a){var e=a("snabbt"),t=(seajs.data.vars,{getAnimations:function(a,e){var t,n=parseInt(a.element.height()?a.element.height():200),s=parseInt(a.element.width()?a.element.width():200);switch(e.show){case"zoomIn":t=[{fromScale:[.8,.8],scale:[1,1],fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:e.speed}];break;case"zoomInDown":t=[{fromScale:[.5,.5],scale:[1,1],fromPosition:[0,-500,0],position:[0,0,0],fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:.7*e.speed}];break;case"expandOpen":t=[{fromScale:[1.8,1.8],scale:[.95,.95],easing:"ease",duration:parseInt(.6*e.speed)},{scale:[1,1],easing:"ease",duration:parseInt(.4*e.speed)}];break;case"fadeIn":t=[{fromScale:[.5,.5],scale:[1,1],fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:parseInt(.6*e.speed)},{scale:[.9,.9],easing:"ease",duration:parseInt(.2*e.speed)},{scale:[1,1],easing:"ease",duration:parseInt(.2*e.speed)}];break;case"fadeInNormal":t=[{fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:e.speed}];break;case"fadeInUp":t=[{fromPosition:[0,n,0],position:[0,0,0],fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:e.speed}];break;case"fadeInDown":t=[{fromPosition:[0,-n,0],position:[0,0,0],fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:e.speed}];break;case"fadeInRight":t=[{fromPosition:[s,0,0],position:[0,0,0],fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:e.speed}];break;case"fadeInLeft":t=[{fromPosition:[-s,0,0],position:[0,0,0],fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:e.speed}];break;case"moveUp":t=[{fromPosition:[0,n,0],position:[0,0,0],fromOpacity:1,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:e.speed}];break;case"moveDown":t=[{fromPosition:[0,-n,0],position:[0,0,0],fromOpacity:1,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:e.speed}];break;case"moveRight":t=[{fromPosition:[-s,0,0],position:[0,0,0],fromOpacity:1,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:e.speed}];break;case"moveLeft":t=[{fromPosition:[s,0,0],position:[0,0,0],fromOpacity:1,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:e.speed}];break;case"rotateIn":t=[{fromRotation:[0,0,Math.PI],rotation:[0,0,0],fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:e.speed}];break;case"rotateInDownLeft":t=[{fromRotation:[0,0,Math.PI/4],rotation:[0,0,0],fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"linear",transformOrigin:[-s/2,n/2,0],duration:e.speed}];break;case"rotateInDownRight":t=[{fromRotation:[0,0,-Math.PI/4],rotation:[0,0,0],fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"linear",transformOrigin:[s/2,n/2,0],duration:e.speed}];break;case"flipInY":t=[{fromRotation:[0,Math.PI/2,0],rotation:[0,20*-Math.PI/180,0],fromOpacity:.4,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:parseInt(.7*e.speed)},{fromRotation:[0,20*-Math.PI/180,0],rotation:[0,0,0],easing:"ease",duration:parseInt(.3*e.speed)}];break;case"flipInX":t=[{fromRotation:[Math.PI/2,0,0],rotation:[20*-Math.PI/180,0,0],fromOpacity:.4,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:parseInt(.7*e.speed)},{fromRotation:[20*-Math.PI/180,0,0],rotation:[0,0,0],easing:"ease",duration:parseInt(.3*e.speed)}];break;case"lightSpeedIn":t=[{fromSkew:[0,-Math.PI/6],skew:[0,20*Math.PI/180],fromOpacity:.4,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,fromPosition:[s,0,0],position:[0,0,0],easing:"ease",duration:parseInt(.6*e.speed)},{skew:[0,5*-Math.PI/180],easing:"ease",duration:parseInt(.2*e.speed)},{skew:[0,0],easing:"ease",duration:parseInt(.2*e.speed)}];break;case"slideRight":t=[{fromPosition:[parseInt(-1.5*s),0,0],position:[parseInt(.08*s),0,0],easing:"ease",duration:parseInt(.6*e.speed)},{position:[parseInt(-.04*s),0,0],easing:"ease",duration:parseInt(.2*e.speed)},{position:[0,0,0],easing:"ease",duration:parseInt(.2*e.speed)}];break;case"slideLeft":t=[{fromPosition:[parseInt(1.5*s),0,0],position:[parseInt(-.08*s),0,0],easing:"ease",duration:parseInt(.6*e.speed)},{position:[parseInt(.04*s),0,0],easing:"ease",duration:parseInt(.2*e.speed)},{position:[0,0,0],easing:"ease",duration:parseInt(.2*e.speed)}];break;case"slideDown":t=[{fromPosition:[0,parseInt(-1*n),0],position:[0,parseInt(.08*n),0],easing:"ease",duration:parseInt(.6*e.speed)},{position:[0,parseInt(-.04*n),0],easing:"ease",duration:parseInt(.2*e.speed)},{position:[0,0,0],easing:"ease",duration:parseInt(.2*e.speed)}];break;case"slideUp":t=[{fromPosition:[0,parseInt(n),0],position:[0,parseInt(-.08*n),0],easing:"ease",duration:parseInt(.6*e.speed)},{position:[0,parseInt(.04*n),0],easing:"ease",duration:parseInt(.2*e.speed)},{position:[0,0,0],easing:"ease",duration:parseInt(.2*e.speed)}];break;case"stretchRight":t=[{fromScale:[.3,1],scale:[1.02,1],easing:"ease",transformOrigin:[-1.2*s,0,0],duration:parseInt(.4*e.speed)},{scale:[.98,1],easing:"ease",duration:parseInt(.2*e.speed)},{scale:[1.01,1],easing:"ease",duration:parseInt(.2*e.speed)},{scale:[1,1],easing:"ease",duration:parseInt(.2*e.speed)}];break;case"stretchLeft":t=[{fromScale:[.3,1],scale:[1.02,1],easing:"ease",transformOrigin:[1.2*s,0,0],duration:parseInt(.4*e.speed)},{scale:[.98,1],easing:"ease",duration:parseInt(.2*e.speed)},{scale:[1.01,1],easing:"ease",duration:parseInt(.2*e.speed)},{scale:[1,1],easing:"ease",duration:parseInt(.2*e.speed)}];break;case"pullUp":t=[{fromScale:[1,.3],scale:[1,1.02],easing:"ease",transformOrigin:[0,n/2,0],duration:parseInt(.6*e.speed)},{scale:[1,.99],easing:"ease",duration:parseInt(.2*e.speed)},{scale:[1,1],easing:"ease",duration:parseInt(.2*e.speed)}];break;case"pullDown":t=[{fromScale:[1,.3],scale:[1,1.02],easing:"ease",transformOrigin:[0,-n/2,0],duration:parseInt(.6*e.speed)},{scale:[1,.99],easing:"ease",duration:parseInt(.2*e.speed)},{scale:[1,1],easing:"ease",duration:parseInt(.2*e.speed)}];break;case"rotateLeft":t=[{fromRotation:[0,0,0],rotation:[0,0,Math.PI],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"ease",duration:parseInt(.8*e.speed)}];break;case"rotateRight":t=[{fromRotation:[0,0,0],rotation:[0,0,-Math.PI],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"ease",duration:parseInt(.8*e.speed)}];break;case"bounceIn":t=[{fromScale:[.5,.5],scale:[1,1],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:0,opacity:1,easing:"ease",duration:parseInt(.6*e.speed)},{scale:[.9,.9],easing:"ease",duration:parseInt(.2*e.speed)},{scale:[1,1],easing:"ease",duration:parseInt(.2*e.speed)}];break;case"wobble":t=[{position:[parseInt(-.25*s),0,0],rotation:[0,5*-Math.PI/180,0],easing:"linear",duration:parseInt(.15*e.speed)},{position:[parseInt(.2*s),0,0],rotation:[0,3*Math.PI/180,0],easing:"linear",duration:parseInt(.15*e.speed)},{position:[parseInt(-.15*s),0,0],rotation:[0,3*-Math.PI/180,0],easing:"linear",duration:parseInt(.15*e.speed)},{position:[parseInt(.1*s),0,0],rotation:[0,2*Math.PI/180,0],easing:"linear",duration:parseInt(.15*e.speed)},{position:[parseInt(-.05*s),0,0],rotation:[0,-Math.PI/180,0],easing:"linear",duration:parseInt(.15*e.speed)},{position:[0,0,0],rotation:[0,0,0],easing:"linear",duration:parseInt(.25*e.speed)}];break;case"swing":t=[{rotation:[0,0,Math.PI*-15/180],transformOrigin:[0,-n,0],easing:"linear",duration:parseInt(.2*e.speed)},{rotation:[0,0,Math.PI*-10/180],transformOrigin:[0,-n,0],easing:"linear",duration:parseInt(.2*e.speed)},{rotation:[0,0,5*Math.PI/180],transformOrigin:[0,-n,0],easing:"linear",duration:parseInt(.2*e.speed)},{rotation:[0,0,Math.PI*-5/180],transformOrigin:[0,-n,0],easing:"linear",duration:parseInt(.2*e.speed)},{rotation:[0,0,0],transformOrigin:[0,-n,0],easing:"linear",duration:parseInt(.2*e.speed)}];break;case"shake":t=[{position:[-10,0,0],easing:"ease",duration:parseInt(.1*e.speed)},{position:[10,0,0],easing:"ease",duration:parseInt(.1*e.speed)},{position:[-10,0,0],easing:"ease",duration:parseInt(.1*e.speed)},{position:[10,0,0],easing:"ease",duration:parseInt(.1*e.speed)},{position:[-10,0,0],easing:"ease",duration:parseInt(.1*e.speed)},{position:[10,0,0],easing:"ease",duration:parseInt(.1*e.speed)},{position:[-10,0,0],easing:"ease",duration:parseInt(.1*e.speed)},{position:[10,0,0],easing:"ease",duration:parseInt(.1*e.speed)},{position:[-10,0,0],easing:"ease",duration:parseInt(.1*e.speed)},{position:[0,0,0],easing:"ease",duration:parseInt(.1*e.speed)}];break;case"jello":t=[{skew:[0,0,0],easing:"ease",duration:parseInt(.11*e.speed)},{skew:[12.5*-Math.PI/180,12.5*-Math.PI/180,0],easing:"ease",duration:parseInt(.11*e.speed)},{skew:[6.25*Math.PI/180,6.25*Math.PI/180,0],easing:"ease",duration:parseInt(.11*e.speed)},{skew:[3.125*-Math.PI/180,3.125*-Math.PI/180,0],easing:"ease",duration:parseInt(.11*e.speed)},{skew:[1.5625*Math.PI/180,1.5625*Math.PI/180,0],easing:"ease",duration:parseInt(.11*e.speed)},{skew:[.78125*-Math.PI/180,.78125*-Math.PI/180,0],easing:"ease",duration:parseInt(.11*e.speed)},{skew:[.390625*Math.PI/180,.390625*Math.PI/180,0],easing:"ease",duration:parseInt(.11*e.speed)},{skew:[.1953125*-Math.PI/180,.1953125*-Math.PI/180,0],easing:"ease",duration:parseInt(.11*e.speed)},{skew:[0,0,0],easing:"ease",duration:parseInt(.12*e.speed)}];break;case"bounce":t=[{position:[0,0,0],easing:"ease",duration:parseInt(.2*e.speed)},{position:[0,-120,0],easing:"ease",duration:parseInt(.2*e.speed)},{position:[0,-120,0],easing:"ease",duration:parseInt(.03*e.speed)},{position:[0,0,0],easing:"ease",duration:parseInt(.1*e.speed)},{position:[0,0,0],easing:"ease",duration:parseInt(.27*e.speed)},{position:[0,-16,0],easing:"ease",duration:parseInt(.1*e.speed)},{position:[0,0,0],easing:"ease",duration:parseInt(.1*e.speed)}];break;case"flash":t=[{fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"ease",duration:parseInt(.25*e.speed)},{fromOpacity:0,opacity:1,easing:"ease",duration:parseInt(.25*e.speed)},{fromOpacity:1,opacity:0,easing:"ease",duration:parseInt(.25*e.speed)},{fromOpacity:0,opacity:"number"==typeof a.data.opacity?a.data.opacity:1,easing:"ease",duration:parseInt(.25*e.speed)}];break;case"pulse":t=[{fromScale:[1,1],scale:[1.05,1.05],easing:"ease",duration:parseInt(.25*e.speed)},{fromScale:[1.05,1.05],scale:[1,1],easing:"ease",duration:parseInt(.25*e.speed)},{fromScale:[1,1],scale:[1.05,1.05],easing:"ease",duration:parseInt(.25*e.speed)},{fromScale:[1.05,1.05],scale:[1,1],easing:"ease",duration:parseInt(.25*e.speed)}];break;case"rubberBand":t=[{fromScale:[1,1],scale:[1.25,.75],easing:"ease",duration:parseInt(.3*e.speed)},{fromScale:[1.25,.75],scale:[.75,1.25],easing:"ease",duration:parseInt(.1*e.speed)},{fromScale:[.75,1.25],scale:[1.15,.85],easing:"ease",duration:parseInt(.1*e.speed)},{fromScale:[1.15,.85],scale:[.95,1.05],easing:"ease",duration:parseInt(.15*e.speed)},{fromScale:[.95,1.05],scale:[1.05,.95],easing:"ease",duration:parseInt(.1*e.speed)},{fromScale:[1.05,.95],scale:[1,1],easing:"ease",duration:parseInt(.25*e.speed)}];break;case"floating":t=[{position:[0,.4*n,0],easing:"ease",duration:parseInt(.5*e.speed)},{position:[0,0,0],easing:"ease",duration:parseInt(.5*e.speed)}];break;case"fadeOut":t=[{fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"ease",duration:parseInt(.8*e.speed)}];break;case"zoomFadeOut":t=[{fromScale:[1,1],scale:[1.3,1.3],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"ease",duration:parseInt(.5*e.speed)},{fromOpacity:0,opacity:0,easing:"ease",duration:parseInt(.5*e.speed)}];break;case"zoomOut":t=[{fromScale:[1,1],scale:[.3,.3],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"ease",duration:parseInt(.5*e.speed)},{fromOpacity:0,opacity:0,easing:"ease",duration:parseInt(.5*e.speed)}];break;case"fadeOutRight":t=[{fromPosition:[0,0,0],position:[s,0,0],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"ease",duration:parseInt(.8*e.speed)}],console.log(t);break;case"fadeOutLeft":t=[{fromPosition:[0,0,0],position:[-s,0,0],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"ease",duration:parseInt(.5*e.speed)}];break;case"fadeOutUp":t=[{fromPosition:[0,0,0],position:[0,-n,0],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"ease",duration:parseInt(.8*e.speed)}];break;case"fadeOutDown":t=[{fromPosition:[0,0,0],position:[0,n,0],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"ease",duration:parseInt(.5*e.speed)}];break;case"rotateOutUpRight":t=[{fromRotation:[0,0,0],rotation:[0,0,-Math.PI/4],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"linear",transformOrigin:[-s/2,n/2,0],duration:parseInt(.8*e.speed)}];break;case"rotateOutUpLeft":t=[{fromRotation:[0,0,0],rotation:[0,0,Math.PI/4],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"linear",transformOrigin:[-s/2,n/2,0],duration:parseInt(.8*e.speed)}];break;case"hinge":t=[{fromRotation:[0,0,0],rotation:[0,0,80*-Math.PI/180],easing:"easeIn",transformOrigin:[-s/2,-n/2,0],duration:parseInt(.2*e.speed)},{fromRotation:[0,0,80*-Math.PI/180],rotation:[0,0,60*-Math.PI/180],easing:"easeIn",transformOrigin:[-s/2,-n/2,0],duration:parseInt(.2*e.speed)},{fromRotation:[0,0,60*-Math.PI/180],rotation:[0,0,80*-Math.PI/180],easing:"easeIn",transformOrigin:[-s/2,-n/2,0],duration:parseInt(.2*e.speed)},{fromRotation:[0,0,60*-Math.PI/180],rotation:[0,0,80*-Math.PI/180],easing:"easeIn",transformOrigin:[-s/2,-n/2,0],duration:parseInt(.2*e.speed)},{fromPosition:[0,0,0],position:[0,700,0],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"easeIn",transformOrigin:[-s/2,-n/2,0],duration:parseInt(.2*e.speed)}];break;case"rotateOut":t=[{fromRotation:[0,0,0],rotation:[0,0,200*-Math.PI/180],fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:1,opacity:0,easing:"ease",duration:parseInt(.8*e.speed)}];break;default:t=[{fromOpacity:"number"==typeof a.data.opacity?a.data.opacity:0,opacity:1}]}return t},getEffect:function(a){var e={};return a.data.animations?(e.show=a.data.animation.show,e.delay=1e3*a.data.animation.delay,e.speed=1e3*a.data.animation.speed):(e.show=a.data.show,e.delay=1e3*a.data.delay,e.speed=1e3*a.data.speed),e.show||(e=!1),e},getInEffect:function(a){var e={};return a.data.animations?(e.show=a.data.animations.animationIn.show,e.delay=a.data.animations.animationIn.delay,e.speed=a.data.animations.animationIn.speed):(e.show=a.data.show,e.delay=a.data.delay,e.speed=a.data.speed),e.show&&"noeffect"!==e.show||(e=!1),e},getOnEffect:function(a){var e={};return a.data.animations?(e.show=a.data.animations.animationOn.show,e.delay=a.data.animations.animationOn.delay,e.speed=a.data.animations.animationOn.speed,e.loop=a.data.animations.animationOn.frequency):(e.show="",e.delay="",e.speed="",e.loop=""),e.show&&"noeffect"!==e.show||(e=!1),e},getOutEffect:function(a){var e={};return a.data.animations?(e.show=a.data.animations.animationOut.show,e.delay=a.data.animations.animationOut.delay,e.speed=a.data.animations.animationOut.speed):(e.show="",e.delay="",e.speed=""),e.show&&"noeffect"!==e.show||(e=!1),e},actAnimation:function(a){var t={};t["in"]=this.getInEffect(a),t.on=this.getOnEffect(a),t.out=this.getOutEffect(a);var n=a.element[0];a.elementout.hide();var s,o={};if(t["in"]){o["in"]=this.getAnimations(a,t["in"]),o["in"][0].startCallback=function(){a.elementout.show(),"site"===a.eletype&&seajs.emit("showSite")},o["in"][0].delay=t["in"].delay>300?parseInt(t["in"].delay-300):0,s=e(n,o["in"][0]);for(var i=1;i<o["in"].length;i++)s.snabbt(o["in"][i])}if(t.on){o.on=this.getAnimations(a,t.on),o.on[0].delay=t.on.delay>300?parseInt(t.on.delay-300):0;for(var r=t.on.loop?t.on.loop:0;r>0;){for(var p=0;p<o.on.length;p++)s?s.snabbt(o.on[p]):s=e(n,o.on[p]),o.on[p].startCallback=function(){a.elementout.show()};r--}}if(t.out){o.out=this.getAnimations(a,t.out),o.out[0].startCallback=function(){a.elementout.show()},o.out[0].callback=function(){a.elementout.hide()},o.out[0].delay=t.out.delay>300?parseInt(t.out.delay-300):0,s||(s=e(n,o.out[0]));for(var d=1;d<o.out.length;d++)s.snabbt(o.out[d])}a.elementout.show()},stopAnimation:function(a){e(a.element[0],"stop"),a.elementout.hide()}});return t});
define("ebook_tools",["jquery","hammer","smsLogin","swiperAni"],function(e){var t=seajs.data.vars,i=e("jquery"),o=e("smsLogin"),a=e("hammer"),n=e("swiperAni");return t.shapesJon={},{scale:function(e,i){return e=parseInt(Math.round(parseInt(e)*(i?t.radio.ratio[i]:t.radio.scaleRatio))),e+"px"},rotate:function(e){return"rotate("+e+"deg)"},imgfilter:function(e){return t.imgUrlReg.test(e)?e:t.imgSite+"imgs/"+e},addpx:function(e){return parseInt(e)+"px"},shadow:function(e){return"0 0 "+this.addpx(e)+" black"},url:function(e){var t;return t=e?/^http(s)?/.test(e)?e:location.protocol+"//"+e:"javascript:void(0);"},isGif:function(e){var t=/\.gif/i;return t.exec(e)},toDou:function(e){return e=parseInt(e),e<10?"0"+e:""+e},getCountDown:function(e,t){var i=(t.deadline_date+" "+t.deadline_time).replace(/-/g,"/");return e.oDate=e.oDate||new Date(i),e.getTime=parseInt((e.oDate.getTime()-(new Date).getTime())/1e3),e.getDay=this.toDou(parseInt(e.getTime/86400)),e.getTime1=e.getTime%86400,e.getHours=this.toDou(parseInt(e.getTime1/3600)),e.getTime1%=3600,e.getMinutes=this.toDou(parseInt(e.getTime1/60)),e.getSeconds=this.toDou(e.getTime1%60),{countDown:e.getDay+":"+e.getHours+":"+e.getMinutes+":"+e.getSeconds,theTime:e.getTime}},render:function(e,o){var a=e.content.data.length;if("bar"===e.content.type||"column"===e.content.type||"line"===e.content.type)switch(e.content.multiple){case 1:if(o.highcharts(this.prepareChartOption(e,0)),o.find("img").remove(),a<=1||a>1&&!e.content.data[1].data)return!1;var n=i("<img/>");n.css({position:"absolute",width:"120px",left:"50%",top:"50%","margin-left":"-60px","margin-top":"-60px","z-index":"99",display:"none"}),n.attr("src",t.imgSite+"imgs/swipewarn.png"),o.append(n),o.find("img").fadeIn(500),setTimeout(function(){o.find("img").fadeOut(500)},2e3);break;default:o.highcharts(this.prepareChartOption(e))}else"pie"===e.content.type&&o.highcharts(this.piePrepareChartOption(e))},normalizeData:function(e){var t=e[0].data,i=[];for(var o in t)t.hasOwnProperty(o)&&i.push({name:t[o][0],y:t[o][1]});return{data:i}},renderPic:function(e){var o,a=this,n=i("<div></div>"),s=i("<div></div>");o=e.borderradius&&e.borderradius>0?null:i("<img/>"),n.css({width:a.scale(e.w),height:a.scale(e.h),left:a.scale(e.left),top:a.scale(e.top,"top"),position:"absolute",opacity:e.opacity,transform:a.rotate(e.rotate)});var r,l,c;e.cropData&&a.isGif(e.picid)?(c="100%",l=0,r=0):(c=a.scale(e.inw),l=a.scale(e.intop),r=a.scale(e.inleft));var p;return p=e.picid?a.imgfilter(e.picid):e.con?e.con:t.imgSite+"imgs/ele/loadingpic.jpg",s.css({position:"absolute",overflow:"hidden","background-clip":"padding-box",width:"100%",height:"100%","border-radius":Math.min(e.borderradius,50)+"%",boxShadow:a.shadow(e.boxshadow)}),e.borderradius&&e.borderradius>0?s.css({"background-image":"url("+p+")","background-repeat":"no-repeat","background-size":c,"background-position":r+" "+l}):(o.css({position:"absolute",width:c,left:r,top:l}),o.attr("src",p),s.append(o)),n.append(s),{eletype:e.type,elementout:n,element:s,data:e,imgSrc:p}},renderText:function(e){var t=this,o=i("<div></div>"),a=i("<div></div>");if(e.version>=21&&a.addClass("no_margin"),o.css({position:"absolute",width:t.scale(e.w),top:t.scale(e.top,"top"),left:t.scale(e.left),height:t.scale(e.height),transform:t.rotate(e.rotate),opacity:e.opacity}),a.css({width:"106%",height:t.scale(e.height),color:e.ftcolor,fontSize:t.scale(e.ftsize),background:e.bgcolor,textAlign:e.textalign,fontWeight:e.fontbold?"bold":"normal",textDecoration:e.udl?"underline":"none",lineHeight:e.lineheight,borderStyle:e["border-style"],borderColor:e["border-color"],borderWidth:t.scale(e["border-width"]),fontStyle:e.fontitalic?"italic":"normal",borderRadius:t.scale(e.borderradius),boxShadow:t.shadow(e.boxshadow),wordWrap:"break-word"}),e.fontFamily&&a.css({"font-family":e.fontFamily}),"text"===e.type){var n;switch(e.textvalign){case"top":n=0;break;case"middle":n=e.h/2-e.tl/2;break;case"bottom":n=e.h-e.tl}a.css({marginTop:t.scale(n),height:"auto"})}if(a.append(e.con),o.append(a),"text"===e.type){var s=a.get(0).firstChild;s&&s.hasChildNodes()&&parseInt(s.style.fontSize)&&(s.style.fontSize=t.scale(parseInt(s.style.fontSize)))}return{eletype:e.type,elementout:o,data:e,element:a}},renderPshape:function(e){var o=this,a=i("<div></div>"),n=i("<div></div>");a.css({position:"absolute",width:o.scale(e.w),height:o.scale(e.h),top:o.scale(e.top),left:o.scale(e.left),transform:o.rotate(e.rotate)}),n.css({position:"absolute",width:o.scale(e.w),height:o.scale(e.h)});var s,r=!1;return e.shape&&"null"!==e.shape&&"0"!==e.shape?"svgDom"===e.shape?(r=!0,s=e.svgDom):s=e.shape.trim().replace(/\//g,"_"):s="1.svg",r||"resolved"!==t.shapesJon[s+"State"]||o.insertSvg([{name:s,data:e,ele:n}],t.shapesJon[s+"File"]),r?o.insertSvg([{data:e,ele:n}],s):t.shapesJon[s+"State"]?"pending"===t.shapesJon[s+"State"]&&t.shapesJon[s].push({name:s,data:e,ele:n}):(i.ajax({url:t.imgSite+"imgs/shape/"+s,type:"GET",dataType:"text",async:!0,success:function(e){t.shapesJon[s+"File"]=e,t.shapesJon[s+"State"]="resolved",o.insertSvg(t.shapesJon[s],e)},error:function(e){t.shapesJon[s+"State"]="failed",console.warn("需要新增的shape文件:",s)}}),t.shapesJon[s+"State"]="pending",t.shapesJon[s]=[],t.shapesJon[s].push({name:s,data:e,ele:n})),a.append(n),{eletype:e.type,elementout:a,data:e,element:n}},insertSvg:function(e,t){for(var i=this,o=e.length-1;o>-1;o--){var a=e[o].data,n=e[o].ele,s=n.html(t).find("svg");s.css({position:"absolute",width:i.scale(a.w),height:i.scale(a.h),opacity:a.opacity}),s.get(0).setAttribute("preserveAspectRatio","none meet"),s.find("[fill]").attr({fill:a.shapecolor}),e.pop()}},renderBtn:function(e){var t=this,o=i("<div></div>"),a=i('<a href="javascript:;"></a>');o.css({position:"absolute",width:t.scale(e.w),height:t.scale(e.height),top:t.scale(e.top),left:t.scale(e.left),transform:t.rotate(e.rotate)}),a.css({position:"absolute",width:"100%",color:e.ftcolor||"#585858",fontSize:t.scale(e.ftsize),lineHeight:e.lineheight,opacity:e.opacity,borderStyle:e["border-style"],borderColor:e["border-color"],borderWidth:t.scale(e["border-width"]),background:e.bgcolor,textAlign:e.textalign,borderRadius:t.scale(e.borderradius),boxShadow:t.shadow(e.boxshadow),textDecoration:"none",wordWrap:"break-word"}),a.append(e.con);var n=a.get(0).firstChild;return n&&n.hasChildNodes()&&parseInt(n.style.fontSize)&&(n.style.fontSize=t.scale(parseInt(n.style.fontSize))),o.append(a),{eletype:e.type,elementout:o,data:e,element:a}},renderRandButton:function(e){var t=this,o=i("<div></div>"),a=i('<a href="javascript:;"></a>');o.css({position:"absolute",width:t.scale(e.w),height:t.scale(e.height),top:t.scale(e.top),left:t.scale(e.left),transform:t.rotate(e.rotate)}),a.css({position:"absolute",width:"100%",color:e.ftcolor||"#585858",fontSize:t.scale(e.ftsize),lineHeight:e.lineheight,opacity:e.opacity,borderStyle:e["border-style"],borderColor:e["border-color"],borderWidth:t.scale(e["border-width"]),background:e.bgcolor,textAlign:e.textalign,borderRadius:t.scale(e.borderradius),boxShadow:t.shadow(e.boxshadow),textDecoration:"none",wordWrap:"break-word"}),e.fontFamily&&a.css({"font-family":e.fontFamily});var n=parseInt(e.maxNum)||0,s=parseInt(e.minNum)||0;s>n&&(n=parseInt(e.minNum)||0,s=parseInt(e.maxNum)||0);var r=Math.ceil(Math.random()*(n-s)+s);a.append(r);var l=a.get(0).firstChild;return l&&l.hasChildNodes()&&parseInt(l.style.fontSize)&&(l.style.fontSize=t.scale(parseInt(l.style.fontSize))),o.append(a),{eletype:e.type,elementout:o,data:e,element:a}},renderPbutton:function(e){var o=this,a=i("<div></div>"),n=i("<a></a>");if(a.css({position:"absolute",height:o.scale(e.tl),top:o.scale(e.top),left:o.scale(e.left),transform:o.rotate(e.rotate),opacity:e.opacity}),"link"===e.model_type||"phone"===e.model_type||"interaction"===e.model_type){n.css({position:"absolute",width:"100%",height:"100%",animationDuration:e.speed+"ms"}),"phone"===e.model_type&&e.phoneNumber&&(e.phoneNumber=e.phoneNumber.replace(/-| /g,"").replace("转",",").replace("，",","));var s=i("<div></div>");s.css({position:"absolute",width:o.scale(e.picwidth),height:o.scale(e.picheight)});var r=i("<div></div>");r.css({position:"absolute",left:o.scale(e.picwidth),width:o.scale(e.width),fontSize:o.scale(e.ftsize),color:e.ftcolor,lineHeight:o.scale(e.lineheight),paddingLeft:"5px"});var l=e.pic_id?e.pic_id.match(/./)[0]:"";t.svgJson=t.svgJson||{};var c=e.button_id;if("interaction"===e.model_type){var p=o.getCookie(t.projectID+"_"+c);p&&(l+="a")}if(l&&!t.svgJson["svg_"+l])i.ajax({url:t.imgSite+"imgs/buttonSvg/"+l+".svg",type:"GET",async:!1,dataType:"text",success:function(a){var n=i(a);n.css({width:o.scale(e.picwidth),height:o.scale(e.picheight)}).find("[fill]").attr({fill:e.ftcolor}),t.svgJson["svg_"+l]=a,s.append(n)}});else{var d=i(t.svgJson["svg_"+l]);d.css({width:o.scale(e.picwidth),height:o.scale(e.picheight)}).find("[fill]").attr({fill:e.ftcolor}),s.append(d)}"link"===e.model_type?n.attr({href:o.url(e.url)}):"phone"===e.model_type&&e.phoneNumber&&n.attr("href","tel:"+e.phoneNumber),r.text(p?p:e.con),n.append(s),n.append(r)}else if("count_down"===e.model_type){n.css({position:"absolute",width:"100%",animationDuration:e.speed+"ms",textAlign:"center",color:e.ftcolor,lineHeight:o.scale(e.lineheight),fontSize:o.scale(e.ftsize)});var h=n.get(0);n.append(o.getCountDown(h,e).countDown),clearInterval(h.timer),h.timer=setInterval(function(){n.html(o.getCountDown(h,e).countDown),o.getCountDown(h,e).theTime<0&&(clearInterval(h.timer),n.html("00:00:00:00"))},1e3)}return a.append(n),n.on("click",{contentico:s,contentText:r},function(a){var n=a.data.contentico,s=a.data.contentText;if("phone"===e.model_type)window.location.href="tel://"+e.phoneNumber;else if("link"===e.model_type&&e.url)window.location.href=o.url(e.url);else if("interaction"===e.model_type){var r=o.getCookie(t.projectID+"_"+c);r||i.ajax({type:"get",url:t.phoneSite,cache:!1,dataType:"json",data:{c:"web",a:"ajaxVote",id:t.projectID,voteId:e.button_id,name:e.projectName},success:function(a){var r;1===a.errcode?l&&!t.svgJson["svg_"+l+"a"]?i.ajax({url:t.imgSite+"imgs/buttonSvg/"+l+"a.svg",type:"GET",dataType:"text",success:function(p){r=i(p),r.css({width:o.scale(e.picwidth),height:o.scale(e.picheight)}).find("[fill]").attr({fill:e.ftcolor}),t.svgJson["svg_"+l+"a"]=p,a.counts&&(o.setCookie(t.projectID+"_"+c,a.counts),n.html(r),s.html(a.counts))}}):(r=i(t.svgJson["svg_"+l+"a"]),r.css({width:o.scale(e.picwidth),height:o.scale(e.picheight)}).find("[fill]").attr({fill:e.ftcolor}),a.counts&&(o.setCookie(t.projectID+"_"+c,a.counts),n.html(r),s.html(a.counts))):console.log(a.errmsg)},error:function(e){console.log("网络错误:",e)}})}}),{eletype:e.type,elementout:a,data:e,element:n}},renderPswiper:function(o,a){var n,s,r,l=this,c=[],p=i('<div class="swiper-container" style="z-index: 0"></div>'),d=i('<div class="swiper-wrapper"></div>'),h=i('<div class="swiper-pagination"></div>');p.css({position:"absolute",width:l.scale(o.width),height:l.scale(o.height),left:l.scale(o.left),top:l.scale(o.top),overflow:"hidden"}),p.append(d),p.append(h),o.data.map(function(e){var a=i("<img/>");a.attr("src",l.imgfilter(e.picid)),n=i('<div class="swiper-slide"></div>'),h.append('<span class="swiper-pagination-bullet"></span>');var p=i("<div></div>");a.css({position:"absolute",width:e.inw?l.scale(e.inw):"",height:e.inh?l.scale(e.inh):"",left:e.inleft?l.scale(e.inleft):"",top:e.intop?l.scale(e.intop):""}),c.push({src:a.attr("src"),w:e.inw?parseInt(l.scale(e.inw)):parseInt(l.scale(o.picWidth)),h:e.inh?parseInt(l.scale(e.inh)):parseInt(l.scale(o.picHeight)),msrc:t.imgSite+"imgs/preloader.gif"}),n.css({width:"100%",height:"100%",overflow:"hidden",background:"#ffffff",lineHeight:"1.5"}),p.css({position:"absolute",overflow:"hidden",width:l.scale(o.picWidth),height:l.scale(o.picHeight)}),p.append(a),n.append(p),e.titleText&&(s=i("<div></div>"),s.css({position:"absolute",width:l.scale(e.titleText.width),left:l.scale(e.titleText.left),top:l.scale(e.titleText.top),fontSize:l.scale(e.titleText.fontsize),lineHeight:e.titleText.lineheight,color:e.titleText.fontcolor}),s.append(e.titleText.con),n.append(s)),e.contentText&&(r=i("<div></div>"),e.contentText.opacity?r.css({position:"absolute",width:"100%",height:"150px",top:l.scale(e.contentText.top),fontSize:l.scale(e.contentText.fontsize),lineHeight:e.contentText.lineheight,color:e.contentText.fontcolor,textAlign:"center",background:"black",opacity:e.contentText.opacity}):r.css({position:"absolute",width:l.scale(e.contentText.width),left:l.scale(e.contentText.left),top:l.scale(e.contentText.top),fontSize:l.scale(e.contentText.fontsize),lineHeight:e.contentText.lineheight,color:e.contentText.fontcolor}),r.append(e.contentText.con),n.append(r)),d.append(n)}),e.async(["photoswipe","photoswipeUI"],function(e,t){var o=i(".pswp")[0],a=0;d.off("click",".swiper-slide"),d.on("click",".swiper-slide",function(){a=i(this).index();var n={history:!1,focus:!1,index:a,showAnimationDuration:0,hideAnimationDuration:0},s=new e(o,t,c,n);s.init()})});var u=new a(p,{pagination:h,paginationClickable:!0,spaceBetween:60,speed:600,longSwipesRatio:.3,loop:!0,observer:!0,observeParents:!0,onTouchStart:function(e){e.update()}});return{elementout:p,swiper:u,wrapper:d,pagination:h,eletype:o.type}},renderPswipers:function(e,t){var o,a=this,s=i('<div class="swiper-container" style="z-index: 0"></div>'),r=i('<div class="swiper-wrapper"></div>'),l="true"===e.animation.auto?e.animation.changeTime:0,c=e.animation.speed?e.animation.speed:.3,p=e.animation.show||"slide",d="",h=/^(slide|fade|cube|coverflow|flip)$/;d=h.test(p)?p:"slide",s.css({position:"absolute",width:a.scale(e.width),height:a.scale(e.height),left:a.scale(e.left),top:a.scale(e.top),overflow:"hidden","z-index":10}),s.append(r),e.data.map(function(t){var n=i("<img/>");n.attr("src",a.imgfilter(t.picid)),o=i('<div class="swiper-slide" ></div>');var s=i("<div></div>");h.test(p)||s.addClass("ani").attr({"swiper-animate-effect":p,"swiper-animate-duration":c+"s","swiper-animate-delay":0}),n.css({position:"absolute",width:t.inw?a.scale(t.inw):"",height:t.inh?a.scale(t.inh):"",left:t.inleft?a.scale(t.inleft):"",top:t.intop?a.scale(t.intop):""}),o.css({width:"100%",height:"100%",overflow:"hidden",lineHeight:"1.5"}),s.css({position:"absolute",overflow:"hidden",width:a.scale(e.picWidth),height:a.scale(e.picHeight)}),s.append(n),o.append(s),r.append(o)});var u={speed:h.test(p)?1e3*c:10,longSwipesRatio:.3,loop:!!h.test(p),autoplay:1e3*l,autoplayDisableOnInteraction:!1,effect:d,observer:!0,observeParents:!0,onInit:function(e){h.test(p)||(n.swiperAnimateCache(e),n.swiperAnimate(e))},onSlideChangeEnd:function(e){h.test(p)||n.swiperAnimate(e)}};return{elementout:s,swiper:null,swiperJson:u,wrapper:r,eletype:e.type,eledata:e.animation}},renderCharts:function(e){var t=this,o=i('<div class="chart-wrapper"></div>'),n=i('<div class="chart"></div>'),s=i('<div class="chart-swipe-legend"></div>'),r=0,l=e.content.data.length,c=e.content.multiple?e.content.multiple:2;switch(e.w=e.w||640,e.h=e.h||("pie"===e.content.type?640:450),o.css({position:"absolute",width:t.scale(e.w),height:t.scale(e.h),left:t.scale(e.left),top:t.scale(e.top),background:"rgba(0,0,0,0)"}),n.css({position:"absolute",width:t.scale(e.w),height:t.scale(e.h),left:"0",top:1===c&&"pie"!==e.content.type?50:0}),s.css({position:"absolute",width:t.scale(e.w),height:t.scale(e.h),left:t.scale(e.left),top:"9px","text-align":"center",background:"rgba(0,0,0,0)"}),setTimeout(function(){t.render(e,n)},1500),c){case 1:if("bar"===e.content.type||"column"===e.content.type||"line"===e.content.type){for(var p=e.content.data,d=0,h=p.length;d<h;d++){var u=i('<span class="swipe-legend-title"></span>');u.css({margin:"7px","font-size":"12px",opacity:"0.3",color:"rgb(152, 152, 152)"}),0===d?u.css({"font-size":"16px",opacity:"1"}):u.css({"font-size":"12px",opacity:"0.3"}),u.html(p[d].name),s.append(u)}o.append(s),s.on("click","span",function(){r=i(this).index(),i(this).css({"font-size":"16px",opacity:"1"}).siblings().css({"font-size":"12px",opacity:"0.3"}),n.highcharts(t.prepareChartOption(e,r))});var f=new a(n[0]);f.on("swipeleft",function(){return!(1===l||l>1&&!e.content.data[1].data)&&(r++,s.find("span").css({"font-size":"12px",opacity:".3"}).eq(r%l).css({"font-size":"16px",opacity:"1"}),void n.highcharts(t.prepareChartOption(e,r%l)))}),f.on("swiperight",function(){return!(1===l||l>1&&!e.content.data[1].data)&&(r%=l,r--,r<0&&(r=l-1),s.find("span").css({"font-size":"12px",opacity:".3"}).eq(r).css({"font-size":"16px",opacity:"1"}),void n.highcharts(t.prepareChartOption(e,r)))})}}return o.append(n),{elementout:o,eletype:e.type,data:e,element:n,chartHeard:s}},prepareChartOption:function(e,t){var i=this,o=e.content,a=e.content.options,n="12px",s=a.lineColor||"gray",r=3===o.multiple?"normal":null,l=void 0===t?o.data:[o.data[t]],c=void 0===t?a.colors:[a.colors[t]],p={chart:{type:o.type,backgroundColor:a.backgroundColor,plotBorderWidth:0,spacingLeft:-5,animation:{duration:300}},title:{text:null},colors:c,credits:{enabled:!1},tooltip:{style:{fontSize:n}},plotOptions:{series:{animation:!0,stacking:r,lineWidth:2},column:{borderColor:"",shadow:!1,stacking:r},line:{dataLabels:{enabled:!0}},bar:{borderWidth:0,stacking:r},area:{stacking:"normal"}},xAxis:{lineColor:s,gridLineColor:s,categories:a.xAxis.categories,tickColor:s,labels:{staggerLines:0,distance:10,style:{paddingTop:"10px",fontSize:n,color:s}}},yAxis:{lineColor:s,gridLineColor:s,max:a.yAxis.max,min:a.yAxis.min,tickPixelInterval:parseInt(i.scale(100)),title:{text:a.yAxis.title.text,style:{color:s},x:5},labels:{style:{fontSize:n,color:s},x:-5}},size:{width:i.scale(e.w-8),height:i.scale(e.h)},series:l,legend:{symbolWidth:12,symbolHeight:12,itemStyle:{fontSize:n}}};return p},piePrepareChartOption:function(e,t){var i=e.content,o=e.content.options,a="12px",n=o.lineColor||"gray",s=void 0===t?this.normalizeData(i.data):this.normalizeData([i.data[t]]),r=o.colors,l={chart:{type:i.type,backgroundColor:o.backgroundColor,animation:{duration:300}},title:{text:null},colors:r,legend:{enabled:!0,useHTML:!0,labelFormatter:function(){return'<div style="font-size: '+a+"; color: "+n+'">'+this.name+"</div>"}},credits:{enabled:!1},tooltip:{pointFormat:"<b>{point.y}</b>",style:{fontSize:a}},plotOptions:{pie:{allowPointSelect:!0,dataLabels:{format:"{percentage:.1f}%",distance:-parseInt(e.width)/12,color:"white",style:{fontSize:"12px"}},showInLegend:!0}},series:[s]};return l},renderVideo:function(e){var o=this,a=i("<div></div>"),n=i("<video></video>"),s=i("<img/>"),r=e.picurl?e.picurl:"",l="";l=r?o.imgfilter(r):e.con?e.con:t.imgSite+"imgs/ele/loadingpic.jpg",a.css({width:o.scale(e.w),height:"auto",left:o.scale(e.left),top:o.scale(e.top,"top"),position:"absolute",opacity:e.opacity,transform:o.rotate(e.rotate)}),n.attr({preload:"auto","webkit-playsinline":null,width:o.scale(e.inw),height:o.scale(e.inh),type:"video/mp4",poster:l,src:e.videourl?e.videourl:""}),s.css({position:"absolute",left:"50%",top:"50%",margin:"-50px 0 0 -50px",opacity:"0.7"}),s.attr("src",t.imgSite+"imgs/play.png");var c=n[0];return a.on("click",function(){t.audio&&(t.audio.pause(),t.musicOff.show(),t.musicOn.hide()),c.paused?(s.fadeOut(300),c.play()):(s.fadeIn(300),c.pause())}),n.on("timeupdate",function(){c.currentTime===c.duration&&(c.currentTime=0,s.fadeIn(300))}),a.append(n),a.append(s),{eletype:e.type,elementout:a,playBtn:s,element:n,data:e}},renderForm:function(e){var a=this,n=i("<div></div>"),s=i("<div></div>"),r=i("<img/>"),l=i("<p>提交中...</p>"),c=i("<div>"+e.btn_name+"</div>"),p=[],d=e.qlist?e.qlist:[];n.css({position:"absolute",width:a.scale(e.w),top:a.scale(e.top),left:a.scale(e.left),transform:a.rotate(e.rotate)}),s.css({"z-index":"999",position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0,0,0,0.9)","text-align":"center",display:"none"}),r.css({"margin-top":"100px"}),r.attr("src",t.imgSite+"imgs/sending.gif"),l.css({margin:"20px auto",width:"80%","text-align":"center",color:"white","font-size":"20px"}),c.css({height:a.scale(80),fontSize:a.scale(30),marginTop:a.scale(20),lineHeight:a.scale(80),background:e.formcolor}),c.addClass("form-submit"),s.append(r),s.append(l);for(var h in d)if(d.hasOwnProperty(h)){var u=i("<input/>");u.attr({pos:h,name:d[h].id,"data-name":d[h].name,placeholder:d[h].name}),u.css({border:"2px solid "+e.formcolor,height:a.scale(80),marginBottom:a.scale(20),fontSize:a.scale(30)}),u.attr({type:"text","class":"form-input"}),n.append(u),p.push(u)}var f,g=null,m=null,v=null,w=/^(13[0-9]|14[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$/i;if("nameTel"===e.limit){f=i('<input name="100" placeholder="请输入验证码" data-name="验证码" >'),f.css({width:"48%",height:a.scale(80),border:"solid 2px "+e.formcolor,marginBottom:a.scale(20),fontSize:a.scale(30),textIndent:a.scale(10),boxSizing:"border-box",display:"none"});var b=i("<div>获取验证码</div>");b.css({width:"46%",border:"solid 2px "+e.formcolor,height:a.scale(80),lineHeight:a.scale(80),marginBottom:a.scale(20),marginTop:a.scale(30),marginLeft:"5%",fontSize:a.scale(30),boxSizing:"border-box",color:"white",textAlign:"center",background:e.formcolor,display:"none"}),m=n.find("input").eq(1),m.on("input",function(){m.val(m.val().replace(/[^-\d]/g,"")),m.val()?(f.css("display","inline-block"),b.css("display","inline-block")):(f.hide(),b.hide())}),b.on("click",function(){m.val()&&w.test(m.val())?(r.attr("src",t.imgSite+"imgs/sending.gif"),l.html("验证码发送中..."),r.attr("src")?l.css("margin","20px auto"):l.css("margin","200px auto"),s.show(),setTimeout(function(){s.fadeOut(300)},2e3),o.send(m.val(),function(){i.post(t.phoneSite+"?c=web&a=ajaxSendCodeLog",{referer:document.referer,eventid:t.projectID+"_"+e.formid,mobile:m.val(),city:t.city}),r.attr("src",t.imgSite+"imgs/sendsucess.png"),r.attr("src")?l.css("margin","20px auto"):l.css("margin","200px auto"),l.html("发送成功!"),s.fadeIn(300),setTimeout(function(){s.fadeOut(300)},2e3)},function(e){r.attr("src",""),r.attr("src")?l.css("margin","20px auto"):l.css("margin","200px auto"),l.html(e),s.fadeIn(300),setTimeout(function(){s.fadeOut(300)},2e3)})):(r.attr("src",""),r.attr("src")?l.css("margin","20px auto"):l.css("margin","200px auto"),l.html("手机号为空或格式不正确"),s.show(),setTimeout(function(){s.fadeOut(300,function(){m.focus()})},1e3))}),n.append(f),n.append(b)}return n.append(c),c.on("click",{inputCode:f},function(i){if(e.limit&&"nameTel"===e.limit){if(g=p[0],m=p[1],v=i.data.inputCode,!g.val())return r.attr("src",""),r.attr("src")?l.css("margin","20px auto"):l.css("margin","200px auto"),l.html("姓名不能为空"),s.fadeIn(300),void setTimeout(function(){s.fadeOut(300,function(){g.focus()})},1e3);if(!m.val()||!w.test(m.val()))return r.attr("src",""),r.attr("src")?l.css("margin","20px auto"):l.css("margin","200px auto"),l.html("手机号为空或格式不正确"),s.fadeIn(300),void setTimeout(function(){s.fadeOut(300,function(){m.focus()})},1e3);if(!v.val())return r.attr("src",""),r.attr("src")?l.css("margin","20px auto"):l.css("margin","200px auto"),l.html("验证码不能为空"),s.fadeIn(300),void setTimeout(function(){s.fadeOut(300,function(){v.focus()})},1e3)}else if(e.limit&&"none"===e.limit){for(var n=p.length,c=!0,d=0;d<n;d++)if(p[d].val().trim()){c=!1;break}if(c)return r.attr("src",""),r.attr("src")?l.css("margin","20px auto"):l.css("margin","200px auto"),l.html("您输入的内容不能全部为空"),s.fadeIn(300),void setTimeout(function(){s.fadeOut(300)},1e3)}var h={};h.eventid=t.projectID+"_"+e.formid,v&&(h.mobilecode=v.val()),h.limit=e.limit,h.city=t.city,h.couponId=e.couponId?e.couponId.trim():"";for(var u in p)p.hasOwnProperty(u)&&(h[p[u].attr("name")]=p[u].val());r.attr("src",t.imgSite+"imgs/sending.gif"),l.html("提交中..."),r.attr("src")?l.css("margin","20px auto"):l.css("margin","200px auto"),s.fadeIn(300),m&&v?o.check(m.val(),v.val(),function(){a.formAjax(h,l,r,s,e.sucmsg)},function(e){l.html(e+"<br>"),r.attr("src",""),r.attr("src")?l.css("margin","20px auto"):l.css("margin","200px auto"),s.fadeIn(300),setTimeout(function(){s.fadeOut(300)},1e3)}):a.formAjax(h,l,r,s,e.sucmsg)}),s.on("click",function(){s.hide()}),{eletype:e.type,elementout:n,data:e,warn:s}},formAjax:function(e,o,a,n,s){i.ajax({type:"POST",url:t.phoneSite+"?c=web&a=ajaxSubSignInfo",cache:!1,dataType:"json",data:e,success:function(e){1===parseInt(e.errcode)?(e.errmsg?o.html(s+"<br>恭喜您获得了"+e.errmsg):o.html(s),a.attr("src")?o.css("margin","20px auto"):o.css("margin","200px auto"),a.attr("src",t.imgSite+"imgs/sendsucess.png"),n.fadeIn(300),setTimeout(function(){n.fadeOut(300)},2e3)):(o.html("提交失败!<br>"+e.errmsg),a.attr("src",""),a.attr("src")?o.css("margin","20px auto"):o.css("margin","200px auto"),n.fadeIn(300),setTimeout(function(){n.fadeOut(300)},2e3))},error:function(){o.html("提交失败!<br>"),a.attr("src",""),a.attr("src")?o.css("margin","20px auto"):o.css("margin","200px auto"),n.fadeIn(300),setTimeout(function(){n.fadeOut(300)},1e3)}})},renderSite:function(e,o){var a=this,n=i("<div></div>"),s=i('<iframe frameborder="0"></iframe>');n.css({width:a.scale(e.w),height:a.scale(e.h),margin:0,padding:0,left:a.scale(e.left),top:a.scale(e.top),"-webkit-overflow-scrolling":"touch","overflow-x":"hidden","overflow-y":"auto",position:"absolute",opacity:e.opacity,backgroundColor:"#fff",transform:a.rotate(e.rotate)}),s.css({position:"absolute",width:a.scale(e.w),left:0,top:0,border:"none"});var r=e.url,l=e.moreThanOneScreen;if(r&&r.indexOf(location.protocol+"//")===-1&&(r=location.protocol+"//"+r),r){var c=function(e){"block"===n.css("display")&&(s.attr("src",r),seajs.off("showSite",c))};seajs.on("showSite",c)}if(o&&"yes"===o.pan){var p=i('<div class="fromRightSlow delay2s">上下滑动翻页</div>'),d=i("<div ></div>");p.css({position:"absolute",width:"30px",height:"160px",right:"0",top:parseInt(a.scale(e.h))-200,backgroundColor:"rgba(0,0,0,.6)",color:"#fff",textAlign:"center",writingMode:"lr-tb",lineHeight:"26px",borderRadius:"15px",paddingTop:"26px"}),d.css({position:"absolute",width:"100%",height:"26px",top:"0",left:"0",background:'url("'+t.imgSite+'/imgs/banner.png") 0 0 no-repeat',backgroundPosition:"10px 4px"}),p.append(d)}if(t.UA.indexOf("iphone")!==-1){if(s.attr("scrolling","no"),o&&"yes"===o.pan){var h=null,u=parseInt(p.css("top"));n.on("scroll",function(){clearTimeout(h),p.css("top",u+n.scrollTop())})}if("off"===l||t.img360Reg.test(r)){var f=i(window).height();s.css("height",f),n.css("height",f)}}else s.css("height",a.scale(e.h));return o&&"yes"===o.pan&&d.on("click",function(){p.hasClass("fromRightSlow")?(p.removeClass("fromRightSlow").removeClass("delay2s").addClass("toRightHide"),setTimeout(function(){d.css({left:"-26px",backgroundPosition:"-16px 4px",backgroundColor:"rgba(0,0,0,.6)",borderRadius:"15px 0 0 15px"})},800)):(p.removeClass("toRightHide").addClass("fromRightSlow"),d.css({left:"0",backgroundPosition:"10px 4px",backgroundColor:"rgba(0,0,0,0)",borderRadius:"none"}))}),n.append(s),n.append(p),{eletype:e.type,elementout:n,element:s,pageTurn:p,pageTurnTop:p?parseInt(p.css("top")):0,seajsEmitRuned:!1,data:e}},getCookie:function(e){for(var t=document.cookie.split("; "),i=0;i<t.length;i++){var o=t[i].split("=");if(o[0]===e)return o[1]}return""},setCookie:function(e,t,i){if(i){var o=new Date;o.setDate(o.getDate()+i),document.cookie=e+"="+t+";path=/;expires="+o.toGMTString()}else document.cookie=e+"="+t+";path=/"},removeCookie:function(e){this.setCookie(e,1,-1)},createFloat:function(){var e=i("<div></div>");return e.css({width:"100%",height:"100%",margin:0,padding:0,left:0,top:0,position:"absolute",opacity:.69,backgroundColor:"#000",zIndex:1e3}),e}}});
define("ebook_page",["jquery","jqueryTransit","ebook_eleAnimation","ebook_tools"],function(e){function t(e,t){this.zIndex=999-t,this.elearray=[],this.videoarr=[],this.toPage=[],this.checkBox=[],this.data=e,this.bgpic=e.bgpic?e.bgpic:null,this.pageeffect=e.effect?e.effect:"cubedown",this.pan=e.pan?e.pan:"yes",this.init(e)}var i=seajs.data.vars,a=e("jquery"),r=e("ebook_tools"),n=e("ebook_eleAnimation");return e("jqueryTransit"),t.prototype={init:function(e){var t=this;this.page=a('<div class="page"> </div>'),this.pagebg=a('<div class="pagebg"></div>'),this.pagecontent=a('<div class="pagecontent"></div>'),this.page.css({"z-index":this.zIndex}),this.pagebg.css({position:"absolute",width:"100%",height:"100%",top:"0",left:"0",overflow:"hidden",backgroundColor:e.bgcolor}),this.bgpic&&(this.bgimg=this.imgfilter(this.bgpic),this.pagebgimg=a('<img  src="'+this.bgimg+'"/>'),this.pagebgimg.css({position:"absolute",opacity:e.opacity,left:t.scale(e.bgpicleft,"left"),top:t.scale(e.bgpictop,"top"),width:e.bgpicwidth?t.scale(e.bgpicwidth,"width"):"100%",height:e.bgpicheight&&"auto"!==e.bgpicheight?t.scale(e.bgpicheight,"height"):"100%","-webkit-filter":"blur("+e.blur+"px)",transform:"rotate("+e.rotate+"deg)","-webkit-transform":"rotate("+e.rotate+"deg)","max-width":"640px"})),this.pagebg.append(this.pagebgimg),this.pagecontent.css(i.radio.contentsize);for(var n in e.content)if(e.content.hasOwnProperty(n)){var o=e.content[n];if(o.index=n,o.left>1200||o.left<-1200)continue;if(o.top>1200||o.top<-1200)continue;var s,c=o.type;switch(c){case"pshape":s=r.renderPshape(o);break;case"ptext":case"text":s=r.renderText(o);break;case"pic":s=r.renderPic(o);break;case"btn":s=r.renderBtn(o);break;case"pButton":s=r.renderPbutton(o);break;case"slide":this.slideCon=o,this.loadSwiper();break;case"eleform":s=r.renderForm(o),this.page.append(s.warn);break;case"charts":this.charts=o,this.loadChart();break;case"video":s=r.renderVideo(o),this.videoarr.push(s.data);break;case"site":i.img360Reg=/(tour\.html)|(img360\.soufunimg\.com)|(aerialPhotoInfo\.htm)|(h5market)/,i.h5market=/(h5market)/,i.img360Reg.test(o.url)&&!i.h5market.test(o.url)&&(this.img360=!0),s=r.renderSite(o,e),this.iframe=!0,this.ele=s;break;case"slides":this.slideCons=o,this.loadSwipers();break;case"rand_button":s=r.renderRandButton(o)}var p=/^(ptext|text|pic|pshape|btn)$/;if(p.test(o.type)&&"click"===o.eventType&&"none"!==o.eventAction){if("changePage"===o.eventAction?t.toPage.push(0|o.toPage):"show"===o.eventAction&&t.checkBox.push(o.checkBox),"object"==typeof o.timer){var h=o.timer.startVal;"timeKeeper"===o.timer.name&&(h=0),h&&t.timeReset(h),i.clock.attr("src",i.imgSite+"imgs/icon-watch.png"),i.h5Timer.css({background:"url("+i.imgSite+"imgs/zfz-ying.png) 22px 4px no-repeat","background-size":"80px 32px"}).show()}t.eleClick(s,o)}s&&(this.elearray.push(s),this.pagecontent.append(s.elementout),s=null)}if(t.checkBox.length)for(var g=0;g<t.checkBox.length;g++)for(var l=0;l<t.checkBox[g].length;l++){var s=t.elearray[t.checkBox[g][l]];s&&(s.initHide=!0)}(e.bgpic||e.bgcolor&&"#ffffff"!==e.bgcolor)&&this.page.append(this.pagebg),e.content.length&&(this.iframe&&this.pagecontent.css("top","0"),this.page.append(this.pagecontent))},imgfilter:function(e){return i.imgUrlReg.test(e)?e:i.imgSite+"imgs/"+e},loadSwiper:function(){var t=this;e.async("swiper",function(e){var i=r.renderPswiper(t.slideCon,e);t.elearray.push(i),t.swiper=i.swiper,t.pagecontent.append(i.elementout),t.swiper.init()})},toDou:function(e){return e=parseInt(e),e<10?"0"+e:""+e},loadSwipers:function(){var t=this;e.async("swiper",function(e){var i=r.renderPswipers(t.slideCons,e);t.swiperPhotos=i.swiper,t.swiperJson=i.swiperJson,t.swiperBox=i.elementout,t.pagecontent.append(i.elementout)})},loadChart:function(){var t=this;e.async(["highcharts","hammer"],function(){var e=r.renderCharts(t.charts);t.chartEle=e,t.elearray.push(e),t.pagecontent.append(e.elementout)})},eleClick:function(t,n){var o=this;t.element.on("click",{ele:t,toPage:n.toPage,toUrl:n.toUrl},function(t){var n=t.data.ele,s=t.data.toPage,c=t.data.toUrl||t.data.url,p=n.data,h=n.imgSrc,g=p.checkBox.length,l=0;switch(p.eventAction){case"magnify":e.async(["photoswipe","photoswipeUI"],function(e,t){var i=a(".pswp")[0],r=[{src:h,w:p.w,h:p.h}],n={history:!1,focus:!1,maxSpreadZoom:3,index:0,showAnimationDuration:0,hideAnimationDuration:0},o=new e(i,t,r,n);o.init()});break;case"hide":for(l=0;l<g;l++)o.elearray[p.checkBox[l]].elementout.fadeOut(500);break;case"show":if(o.data.showFloat&&!o.data.created){o.data.created=!0;var m=r.createFloat();o.pagecontent.append(m)}for(l=0;l<g;l++){var d=o.elearray[p.checkBox[l]];d&&d.elementout.css("z-index","1001").fadeIn(500)}break;case"changePage":var u=i.current;if("object"==typeof p.timer){"number"!=typeof i.timerStartPage&&(i.timerStartPage=u);var f;switch(p.timer.name){case"countDown":if(i.timerStartVal=p.timer.startVal,i.timerToPage=p.timerToPage,i.timerEndPage=p.timerEndPage,f={type:"countDown",startVal:i.timerStartVal,timerToPage:i.timerToPage,timerEndPage:i.timerEndPage},i.timerStartVal>3600){console.warn("设置倒计时超过60min");break}break;case"timeKeeper":i.timerEndPage=p.timerEndPage,f={type:"timeKeeper",timerEndPage:i.timerEndPage}}o.timeUpDown(f)}o.changePage(s);break;case"toUrl":c&&(/http(s?):\/\//.test(c)||(c=location.protocol+"//"+c),window.location.href=c)}})},changePage:function(e){var t=this;if(parseInt(e)===i.current)return!1;if(i.eles.preview.turn("page",i.current+1),i.timerEndPage&&i.timerEndPage.length&&i.upDownTimer)for(var n=0;n<i.timerEndPage.length;n++)if(parseInt(i.timerEndPage[n])===parseInt(e)){clearTimeout(i.upDownTimer);break}i.pages[e].img360&&i.setMusic("off"),i.pages[e].showPageInAnimation(),i.editorCard.loadPage(i.editorCard.data,e),i.pages[e].charts&&(a(i.pages[e].chartEle.element[0]).html(""),r.render(i.pages[e].charts,a(i.pages[e].chartEle.element[0]))),i.pages[e].swiperJson&&(i.pages[e].swiperTj?i.pages[e].swiperTj.init():i.pages[e].swiperTj=new Swiper(i.pages[e].swiperBox,i.pages[e].swiperJson)),i.current=parseInt(e),i.current===i.timerStartPage&&t.timeReset(i.timerStartVal)},timeReset:function(e,t){var a,r,n=this;e=e||0,a=n.toDou(parseInt(e/60)),r=n.toDou(parseInt(e%60)),i.timeM.html(a),i.timeS.html(r),t||(e<10?i.gameTime.css("color","red"):e<20?i.gameTime.css("color","yellow"):i.gameTime.css("color","white"))},timeUpDown:function(e){var t,a=this,r=e.type,n=e.startVal,o=e.timerToPage;i.upDownTimer=null;var s=function(){a.timeReset(n),n--,clearTimeout(i.upDownTimer),i.upDownTimer=setTimeout(function(){n>=0?s():a.changePage(o)},1e3)},c=function(){t=t||0,a.timeReset(t,"timeKeeper"),t++,clearTimeout(i.upDownTimer),i.upDownTimer=setTimeout(function(){c()},1e3)};"countDown"===r?s():"timeKeeper"===r&&c()},loadelespic:function(e,t){this.bgpic&&t.addpic(this.bgimg);for(var i in this.elearray)this.elearray.hasOwnProperty(i)&&"pic"===this.elearray[i].eletype&&t.addpic(this.elearray[i].imgSrc)},hidePageElement:function(){a.each(this.elearray,function(e,t){"charts"===t.eletype||"slide"===t.eletype||"slides"===t.eletype||"eleform"===t.eletype?t.elementout.hide():n.stopAnimation(t)}),this.hide=!0},showPageInAnimation:function(e){a.each(this.elearray,function(e,t){t.initHide?t.elementout.hide():"charts"===t.eletype||"slide"===t.eletype||"eleform"===t.eletype?t.elementout.fadeIn():"site"===t.eletype?(t.elementout.fadeIn().scrollTop(0),t.pageTurn&&t.pageTurn.css("top",t.pageTurnTop),t.seajsEmitRuned||seajs.emit("showSite")):"slides"===t.eletype?t.eledata.auto&&setTimeout(function(){t.swiper.startAutoplay()},4e3):n.actAnimation(t)}),this.hide=!1,e&&e()},scale:function(e,t){return e=parseInt(Math.round(parseInt(e)*(t?i.radio.ratio[t]:i.radio.scaleRatio))),e+"px"}},t});
define("ebook_card",["jquery","ebook_page","ebook_tools","turn"],function(e){function t(e,t,a,s,n,r){this.data=e,this.containner=t,this.versionData=s,this.viewerIsvip=n,a&&(this.music=a,a.id?this.musicsrc=i.imgUrlReg.test(a.id)?a.id:i.imgSite+"music/"+a.id+".mp3":this.musicsrc=i.imgUrlReg.test(a.name)?a.name:i.imgSite+"webMusic/"+a.name),this.designer=r,this.init(e),this.initTurn()}var i=seajs.data.vars,a=e("jquery"),s=e("ebook_page"),n=e("ebook_tools");return e("turn"),t.prototype={ensureCanvas:function(){var e,t,s,n,r={},o=640,h=1008,p=i.screen.width/o,g=i.screen.height/h;r.scaleRatio=p,r.bgScaleRatio=p<g?p:g,g>p?(e=o>i.screen.width?i.screen.width:o,t=e*(h/o),s=o<i.screen.width?(i.screen.width-o)/2:0,n=t<i.screen.height?(i.screen.height-t)/2:0):(t=h>i.screen.height?i.screen.height:h,e=t*(o/h),n=h<i.screen.height?(i.screen.height-h)/2:0,s=e<i.screen.width?(i.screen.width-e)/2:0),r.ratio={height:g,top:g,width:p,left:p},r.contentsize={width:i.screen.width+"px",height:i.screen.height+"px",left:0,top:0,position:"absolute"};var c={width:"100%",height:"100%",left:"0px",top:"0px",position:"relative"};/iphone|ipad|ipod|ios|android|adr|linux;|symbianos|windows phone/i.test(navigator.userAgent)||window.top!==window||(i.isPc=!0,c={width:"414px",height:"736px",position:"relative","box-shadow":"0 10px 50px rgba(0,0,0,.3)"},r.scaleRatio=.646875,r.bgScaleRatio=.646875,r.ratio={height:.646875,top:.646875,width:.646875,left:.646875},r.contentsize={width:"414px",height:"736px",left:0,top:0,position:"absolute"}),a("#main").css(c),i.radio=r},initTurn:function(){var e=this,t=i.eles;i.eles.preview.turn({elevation:50,display:"single",inclination:50,gradients:!0,duration:800,autoCenter:!0,when:{start:function(){var t=e.pages[i.current+1];if(t){var a=t.page;a.show()}},turning:function(a,s,n,r){/^(tr|br|r)$/.test(r)?e.nextpage():/^(tl|bl|l)$/.test(r)&&e.prevpage(),1!==s&&s!==i.pageNum&&(t.previousPage.hasClass("active")||t.previousPage.addClass("active"),t.indexPage.hasClass("active")||t.indexPage.addClass("active"),t.nextPage.hasClass("active")||t.nextPage.addClass("active"))},first:function(){t.previousPage.removeClass("active"),t.indexPage.removeClass("active")},last:function(){t.nextPage.removeClass("active")}}})},init:function(e){return!("undefined"==typeof e||!e)&&(this.ensureCanvas(),this.pages=[],this.toPageArr=[],this.maxLoadPage=0,this.toLoadPage=2,this.totalPage=e.length-1,i.pageNum=e.length,this.pageLoadStep=3,this.loadPage(e,0),void(i.current=0))},loadPage:function(e,t){if(t=Math.ceil(t/this.pageLoadStep)*this.pageLoadStep,!(t>=i.pageNum)){var a=t+this.pageLoadStep<i.pageNum?t+this.pageLoadStep:i.pageNum;if(a>this.maxLoadPage)for(var n=t;n<a;n++)if(!this.pages[n]||!this.pages[n].loaded){var r=new s(e[n],n);r.loaded=!0,r.toPage.length&&(this.toPageArr=this.toPageArr.concat(r.toPage)),this.pages.push(r),this.containner.append(r.page[0]),i.eles.preview.turn("addPage",r.page),r.hidePageElement()}this.maxLoadPage=a-1;var o=Math.max.apply(Math,this.toPageArr);o>0&&(this.toLoadPage=o),this.toLoadPage>this.maxLoadPage&&this.loadPage(e,this.maxLoadPage+1),i.pages=this.pages}},hasNextPage:function(){return!(i.current>=i.pageNum-1)},debouncedCallback:function(e,t){var i=t;return function(){i--,e()}},start:function(e,t,a){if("undefined"!=typeof this.pages&&this.pages[e]&&("undefined"==typeof t&&(this.pages[e].page.show(),"no"!==this.pages[e].pan&&this.pages[e+1]?i.eles.nav.show():i.eles.nav.hide(),this.pages[e].hidePageElement(),this.pages[e].showPageInAnimation(),this.pages[e].swiperJson&&(this.pages[e].swiperPhotos?this.pages[e].swiperPhotos.init():this.pages[e].swiperPhotos=new Swiper(this.pages[e].swiperBox,this.pages[e].swiperJson)),i.current=e,!this.pages[e-1]&&this.pages[e].iframe&&i.eles.nav.hide()),"undefined"!=typeof t&&0===t))for(var s in this.pages)this.pages.hasOwnProperty(s)&&this.pages[s].loadelespic(s,a)},nextpage:function(e){var t=this;if(this.hasNextPage()){if(i.timerEndPage&&i.timerEndPage.length&&i.upDownTimer)for(var s=0;s<i.timerEndPage.length;s++)if(parseInt(i.timerEndPage[s])===parseInt(i.current+1)){clearTimeout(i.upDownTimer);break}i.pages[i.current+1].img360&&i.setMusic("off"),!(i.current%this.pageLoadStep)&&i.current+this.pageLoadStep>this.maxLoadPage&&t.loadPage(this.data,i.current+this.pageLoadStep);var r=this.pages[i.current],o=r.page,h=this.pages[i.current+1],p=h.page;"no"===h.pan||h.iframe?i.eles.nav.hide():i.eles.nav.show();var g=o.find("video"),c=p.find("video");if(this.pages[i.current+1].charts){var d=this.pages[i.current+1].chartEle;d.element.html(""),d.chartHeard.children().eq(0).css({"font-size":"16px",opacity:"1"}).siblings().css({"font-size":"12px",opacity:"0.3"}),setTimeout(function(){t.pages[i.current].chartEle&&n.render(t.pages[i.current].charts,t.pages[i.current].chartEle.element)},500)}if(g.length&&g.each(function(e,t){t.pause(),a(t).next().fadeIn(300)}),c.length)for(var u=this.pages[i.current+1].videoarr,l=u.length,f=0;f<l;f++)u[f].autoplay&&"auto"===u[f].autoplay&&(c[f].currenTime=0,c[f].play(),document.webkitCancelFullScreen&&document.webkitCancelFullScreen(),c[f].webkitPlaysinline=!0,a(c[f]).next().hide(),u[f].autoplay="false");p.show(),h.showPageInAnimation(),h.swiperJson&&(h.swiperPhotos?h.swiperPhotos.init():h.swiperPhotos=new Swiper(h.swiperBox,h.swiperJson)),i.current<this.pages.length&&i.current++,e&&e()}},prevpage:function(e){var t=this;if(0===i.current)return!1;var s=this.pages[i.current],r=s.page,o=this.pages[i.current-1],h=o.page;if("no"===o.pan||o.iframe?i.eles.nav.hide():i.eles.nav.show(),this.pages[i.current-1].charts){var p=this.pages[i.current-1].chartEle;p.element.html(""),p.chartHeard.children().eq(0).css({"font-size":"16px",opacity:"1"}).siblings().css({"font-size":"12px",opacity:"0.3"}),setTimeout(function(){t.pages[i.current].chartEle&&n.render(t.pages[i.current].charts,t.pages[i.current].chartEle.element)},500)}var g=r.find("video"),c=h.find("video");if(g.length&&g.each(function(e,t){t.pause(),a(t).next().fadeIn(300)}),c.length)for(var d=this.pages[i.current-1].videoarr,u=d.length,l=0;l<u;l++)d[l].autoplay&&"auto"===d[l].autoplay&&(c[l].play(),c[l].webkitPlaysinline=!0,d[l].autoplay="false",a(c[l]).next().hide());h.show(),o.showPageInAnimation(),o.swiperJson&&(o.swiperPhotos?o.swiperPhotos.init():o.swiperPhotos=new Swiper(o.swiperBox,o.swiperJson)),i.current>0&&i.current--,e&&e()},fitscreen:function(e,t){var i=e*a(window).width()/640,s=e*a(window).height()/1010;this.sc=i>s?i:s,this.scale=e;for(var n in this.pages)this.pages.hasOwnProperty(n)&&this.pages[n].fitscreen(e,t);this.initEraser=!0},initEraser:!1},t});
define("ebook_preloader",["jquery","ebook_card"],function(n){function e(){this.queue=[],this.endnum=0,this.curnum=0,this.addingI=0,d.html("0%")}var a=seajs.data.vars,o=n("jquery");n("ebook_card");var d=o("#persent"),i=o("#covert"),r=o("#cover"),t=o(".pie1"),u=o(".pie2"),s=o(".wthum"),c=o("#preloadarea"),g=o("#defaultLoading"),m=o("#customLoading");return window.isLoad=!1,a.imgsBox={},a.imgsrcBox={},e.prototype={loadFonts:function(n){var e=n.fontinfo||null,d=[];if(e){e=JSON.parse(e);for(var i="",r=0,t=e.length;r<t;r++)i+='@font-face {font-family: "'+e[r].font+'"; src: url("'+(a.fontMain+e[r].fontmin)+'");}\n',d.push(e[r].font)}var u=o(document.head),s=o("<style></style>"),c=o("#fontPreloader");s.append(i),u.append(s);for(var r=0,g=d.length;r<g;r++)!function(n,e){var a=o("<p>字体预加载</p>");a.css("font-family",d[n]),c.append(a),n===e-1&&c.hide()}(r,g)},addpic:function(n){"undefined"!==n&&(this.queue.push(n),this.endnum++)},loadingType:function(n,e,a){var o=this;if(n=n||"",e=e||"",a=a||"",e)m.show();else if(g.show(),s.removeClass("waitthum infinite").hide(),i.show(),r.fadeIn(),0===a||!o.queue.length||o.addingI>=360)clearInterval(o.loading),d.html("100%"),t.css({rotate:"0deg"}).show(),u.css({rotate:"180deg"}).show(),o.loadend(n);else{var c=parseInt(o.curnum/o.endnum*360)-o.addingI;o.addingI+=c,o.addingI>=360&&(o.addingI=360),o.addingI<=180?(t.css({rotate:o.addingI+"deg"}).show(),u.css({background:"white"}).show()):o.addingI>180&&o.addingI<=360&&(t.css({rotate:"180deg"}).show(),u.css({background:"rgba(175,228,221,1)",rotate:o.addingI+"deg"}).show()),d.html(parseInt(o.addingI/360*100)+"%")}},loadstart:function(n){var e=this;e.editorMakacard=n,clearInterval(e.loading),e.loading=setInterval(function(){e.loadingType(n,a.loadingSrc,e.endnum),e.curnum<e.endnum?(a.imgsBox["img"+e.curnum]=new Image,a.imgsBox["img"+e.curnum].src=e.queue[e.curnum],a.imgsBox["img"+e.curnum].onload=function(){a.imgsrcBox["img"+e.curnum]=a.imgsBox["img"+e.curnum]&&a.imgsBox["img"+e.curnum].src,e.curnum++},a.imgsBox["img"+e.curnum].onerror=function(){alert("图片加载失败。"),clearInterval(e.loading)}):e.curnum>=e.endnum&&(!!a.loadingSrc||e.addingI>=360)&&(clearInterval(e.loading),e.loadend(n))},30)},loadend:function(n){setTimeout(function(){c.fadeOut(),n.start(0),window.isLoad=!0,a.eles.nav.show()},500)}},e});
define("ebook_pageeffect",["jquery","snabbt"],function(a){var o=a("snabbt"),i={getLeaveEffect:function(a,i){var r=null,n=window.innerHeight,t=window.innerWidth;if(a)switch(a){case"cubedown":r=o(i,{transformOrigin:[0,0,n/2],fromRotation:[0,0,0],fromPosition:[0,0,0],fromScale:[1,1],fromOpacity:1,rotation:[Math.PI/2,0,0],manual:!0,easing:"linear",duration:500});break;case"toup":r=o(i,{transformOrigin:[0,0,0],fromRotation:[0,0,0],fromPosition:[0,0,0],fromScale:[1,1],fromOpacity:1,position:[0,-n,0],manual:!0,easing:"linear",duration:500});break;case"moveup":case"pushup":r=o(i,{transformOrigin:[0,0,0],fromRotation:[0,0,0],fromPosition:[0,0,0],fromScale:[1,1],fromOpacity:1,position:[0,-n,0],manual:!0,easing:"linear",duration:500});break;case"flipup":r=o(i,{transformOrigin:[0,0,0],fromRotation:[0,0,0],fromPosition:[0,0,0],fromScale:[1,1],fromOpacity:1,rotation:[Math.PI/2,0,0],manual:!0,easing:"linear",duration:500});break;case"news":r=o(i,{transformOrigin:[0,0,0],fromScale:[1,1],fromRotation:[0,0,0],fromPosition:[0,0,0],fromOpacity:1,rotation:[0,0,5*Math.PI],scale:[.6,.6],opacity:0,manual:!0,easing:"ease",duration:700});break;case"scaleup":r=o(i,{transformOrigin:[0,0,0],fromOpacity:1,fromScale:[1,1],fromRotation:[0,0,0],fromPosition:[0,0,0],rotation:[0,0,0],scale:[.6,.6],opacity:0,manual:!0,easing:"ease",duration:500});break;case"carouup":r=o(i,{transformOrigin:[0,0,0],fromOpacity:1,fromScale:[1,1],fromRotation:[0,0,0],fromPosition:[0,0,0],position:[0,-n,0],scale:[.6,.6],manual:!0,easing:"ease",duration:500});break;case"fall":r=o(i,{transformOrigin:[-t/2,-n/2,0],fromOpacity:1,fromScale:[1,1],fromRotation:[0,0,0],fromPosition:[0,0,0],position:[0,n,0],rotation:[0,0,-.3],manual:!0,easing:"ease",duration:800});break;default:r=o(i,{position:[0,-n,0],fromPosition:[0,0,0],scale:[1,1],rotation:[0,0,0],manual:!0,easing:"linear",duration:500})}return r},getEntryEffect:function(a,i){var r=null,n=window.innerHeight;if(a)switch(a){case"cubedown":r=o(i,{fromRotation:[-Math.PI/2,0,0],fromPosition:[0,0,0],fromScale:[1,1],fromOpacity:1,position:[0,0,0],rotation:[0,0,0],transformOrigin:[0,0,n/2],manual:!0,easing:"linear",duration:500});break;case"toup":r=o(i,{transformOrigin:[0,0,0],fromRotation:[0,0,0],fromPosition:[0,0,0],fromScale:[1,1],fromOpacity:1,position:[0,0,0],manual:!0,easing:"linear",duration:500});break;case"moveup":case"pushup":r=o(i,{transformOrigin:[0,0,0],fromScale:[1,1],fromRotation:[0,0,0],fromPosition:[0,n,0],position:[0,0,0],manual:!0,easing:"linear",duration:500});break;case"flipup":r=o(i,{transformOrigin:[0,0,0],fromScale:[1,1],fromRotation:[-Math.PI/2,0,0],fromPosition:[0,0,0],rotation:[0,0,0],manual:!0,easing:"easeIn",duration:500,delay:400});break;case"news":r=o(i,{transformOrigin:[0,0,0],fromOpacity:0,fromScale:[.6,.6],fromRotation:[0,0,5*Math.PI],fromPosition:[0,0,0],rotation:[0,0,0],scale:[1,1],opacity:1,manual:!0,easing:"ease",duration:700,delay:1e3});break;case"scaleup":r=o(i,{transformOrigin:[0,0,0],fromOpacity:0,fromScale:[1.2,1.2],fromRotation:[0,0,0],fromPosition:[0,0,0],rotation:[0,0,0],scale:[1,1],opacity:1,manual:!0,easing:"ease",duration:500});break;case"carouup":r=o(i,{transformOrigin:[0,0,0],fromOpacity:1,fromScale:[.9,.9],fromRotation:[0,0,0],fromPosition:[0,0,0],position:[0,0,0],scale:[1,1],manual:!0,easing:"ease",duration:500});break;default:r=o(i,{transformOrigin:[0,0,0],fromScale:[1,1],fromRotation:[0,0,0],fromPosition:[0,0,0],fromOpacity:1,scale:[1,1],manual:!0,easing:"easeIn",duration:500})}return r},getOutEffect:function(a,i){var r=null,n=window.innerHeight;if(a)switch(a){case"cubedown":r=o(i,{fromPosition:[0,0,0],scale:[1,1],fromRotation:[0,0,0],rotation:[-Math.PI/2,0,0],transformOrigin:[0,0,n/2],manual:!0,easing:"linear",duration:500});break;case"toup":r=o(i,{position:[0,0,0],fromPosition:[0,0,0],transformOrigin:[0,0,0],fromScale:[1,1],rotation:[0,0,0],manual:!0,easing:"linear",duration:500});break;case"moveup":case"pushup":r=o(i,{position:[0,n,0],fromPosition:[0,0,0],transformOrigin:[0,0,0],fromScale:[1,1],rotation:[0,0,0],manual:!0,easing:"linear",duration:500});break;case"flipup":r=o(i,{transformOrigin:[0,0,0],fromScale:[1,1],fromRotation:[0,0,0],fromPosition:[0,0,0],rotation:[Math.PI/2,0,0],manual:!0,easing:"easeIn",duration:500});break;case"news":r=o(i,{transformOrigin:[0,0,0],fromOpacity:1,fromScale:[1,1],fromRotation:[0,0,5*Math.PI],fromPosition:[0,0,0],rotation:[0,0,0],scale:[.6,.6],opacity:0,manual:!0,easing:"ease",duration:700});break;case"scaleup":r=o(i,{transformOrigin:[0,0,0],fromOpacity:1,fromScale:[1,1],fromRotation:[0,0,0],fromPosition:[0,0,0],rotation:[0,0,0],scale:[1.2,1.2],opacity:0,manual:!0,easing:"ease",duration:500});break;default:r=o(i,{fromPosition:[0,0,0],fromRotation:[0,0,0],position:[0,0,0],scale:[1,1],rotation:[0,0,0],manual:!0,easing:"linear",duration:500})}return r},getBackEffect:function(a,i){var r=null,n=window.innerHeight;if(a)switch(a){case"cubedown":r=o(i,{fromRotation:[Math.PI/2,0,0],fromPosition:[0,0,0],rotation:[0,0,0],transformOrigin:[0,0,n/2],manual:!0,easing:"linear",duration:500});break;case"toup":r=o(i,{position:[0,0,0],fromPosition:[0,-n,0],transformOrigin:[0,0,0],fromScale:[1,1],rotation:[0,0,0],manual:!0,easing:"linear",duration:500});break;case"moveup":case"pushup":r=o(i,{transformOrigin:[0,0,0],fromPosition:[0,-n,0],fromScale:[1,1],fromRotation:[0,0,0],position:[0,0,0],rotation:[0,0,0],manual:!0,easing:"linear",duration:500});break;case"flipup":r=o(i,{transformOrigin:[0,0,0],fromScale:[1,1],fromRotation:[-Math.PI/2,0,0],fromPosition:[0,0,0],rotation:[0,0,0],manual:!0,easing:"easeIn",duration:500,delay:400});break;case"news":r=o(i,{transformOrigin:[0,0,0],fromOpacity:0,fromScale:[.6,.6],fromRotation:[0,0,5*Math.PI],fromPosition:[0,0,0],rotation:[0,0,0],scale:[1,1],opacity:1,manual:!0,easing:"ease",duration:700,delay:1e3});break;case"scaleup":r=o(i,{transformOrigin:[0,0,0],fromOpacity:0,fromScale:[.6,.6],fromRotation:[0,0,0],fromPosition:[0,0,0],rotation:[0,0,0],scale:[1,1],opacity:1,manual:!0,easing:"ease",duration:500});break;case"carouup":r=o(i,{transformOrigin:[0,0,0],fromOpacity:1,fromScale:[.6,.6],fromRotation:[0,0,0],fromPosition:[0,-n,0],position:[0,0,0],scale:[1,1],manual:!0,easing:"linear",duration:500});break;default:r=o(i,{transformOrigin:[0,0,0],fromPosition:[0,-n,0],fromRotation:[0,0,0],fromOpacity:1,fromScale:[1,1],position:[0,0,0],rotation:[0,0,0],scale:[1,1],manual:!0,easing:"linear",duration:800})}return r}};return i});
define("src/ebook/main",["jquery","ebook_card","ebook_preloader","weixinshare"],function(e){function t(){this.thum=null,this.viewerPreloader=new o,this.init(),i.setMusic=this.setMusic}var i=seajs.data.vars={},a=e("jquery"),n=e("ebook_card"),o=e("ebook_preloader");a("input[type=hidden]").each(function(e,t){i[t.id]=t.value}),i.fontMain=location.protocol+"//static.soufunimg.com/font",i.imgUrlReg=/(^(https?:)?\/\/cdn[n|s]\.soufunimg\.com)|((https?:)?\/\/img\w{0,3}\.soufunimg\.com)|(^(https?:)?\/\/\w+\.soufunimg\.com\/h5)/,/https/.test(location.protocol)&&(i.phoneSite=i.phoneSite.replace("http:","https:"));var s=window,r=a("#main"),c=a("#musiccontrolon"),d=a("#musiccontroloff"),u=a("#marketdym"),l=a("body"),m=a("#defaultLoading"),h=a("#customLoading"),p=a("#nav"),g=a("#previousPage"),f=a("#nextPage"),v=a("#return");i.eles={preview:u,nav:p,previousPage:g,nextPage:f,indexPage:v};var w=a(window);return i.screen={width:r.outerWidth()||w.width(),height:r.outerHeight()||w.height()},i.musicOn=c,i.musicOff=d,i.UA=window.navigator.userAgent.toLowerCase(),i.loadingSrc?h.show():m.show(),i.h5Timer=a("#h5Timer"),i.gameTime=a("#gameTime"),i.timeM=a("#gameMinute"),i.timeS=a("#gameSecond"),i.clock=a("#clock"),t.prototype={constructor:t,init:function(){this.getJson(i.projectID,i.type),!i.isPc&&i.UA.indexOf("test.")>-1&&(e.async(["//static.soufunimg.com/count/loadforwapandm.min.js"]),e.async("//static.soufunimg.com/count/loadonlyga.min.js"))},imgfilter:function(e){return i.imgUrlReg.test(e)?e:i.imgSite+"imgs/"+e},setWXmsg:function(t){this.title=t.data.title,this.thum=t.data.cover?t.data.cover:s.defaultImg,this.status=t.data.status,this.desc=t.data.introduction,this.link=i.phoneSite+i.projectID+"?channel="+i.channel+"&city="+i.city+"&source="+i.source;var n=this.imgfilter(this.thum),o=location.protocol;this.imgUrl=n.indexOf(o)!==-1?n:o+n;var r=e("weixinshare");new r({debug:!1,shareTitle:this.title,descContent:this.desc,lineLink:this.link,imgUrl:this.imgUrl,swapTitle:!1},function(e){var t=e.errMsg,n={c:"web",a:"ajaxWeiXinShareCount",id:i.projectID,type:t.indexOf("sendAppMessage")>-1?"0":"1"};a.ajax({url:i.phoneSite,type:"GET",data:n,dataType:"json",success:function(e){1===e.errcode}})})},getJson:function(e,t){var n=this;a.ajax({type:"get",url:i.phoneSite,cache:!1,data:{c:"api",a:"m"===t?"ajaxMultiTemplateById":"ajaxProject",t:t,id:e},success:function(e){n.getJsonSuccess(e)},error:function(){alert("获取数据失败")}})},getJsonSuccess:function(e){var t=this;if(1!==parseInt(e.errcode))return void alert("获取数据失败!");if("offline"===e.data.status){var o=a('<img style="max-width:100%;max-height:100%;position:relative;z-index:10000;" src="'+i.imgSite+'imgs/offline.jpg">');return l.css("text-align","center").append(o),void r.hide()}if("delete"===e.data.status){var m=a('<img style="max-width:100%;max-height:100%;position:relative;z-index:10000;" src="'+i.imgSite+'imgs/delete.jpg">');return l.css("text-align","center").append(m),void r.hide()}var h=e.data.pdata.json?e.data.pdata.json[0].content:null;if(h){var w=0;a.each(h,function(e,t){var i;t.animations?i=t.animations.animationIn:t.elementAnimations&&(i=t.elementAnimations.animation_in);var a=i.speed+i.delay;w<a&&(w=a)}),s.showTime=w}t.setWXmsg(e),e.data.pdata.json&&1===e.data.pdata.json.length&&p.hide();var y=e.data.pdata.json,j=e.data.pdata.music?e.data.pdata.music:null,x=new n(y,u,j,this.versionData,this.viewerIsvip,this.designer);if(window.editorCard=i.editorCard=x,x.start(0,0,t.viewerPreloader),t.viewerPreloader.loadFonts(e.data),t.viewerPreloader.loadstart(x),x.musicsrc){c.attr("src",i.imgSite+"/imgs/musicon.png").show(),d.attr("src",i.imgSite+"/imgs/musicoff.png").hide();var k=document.getElementById("music");i.audio=k,k.src=x.musicsrc,a(document).one("touchstart",function(){k.play()}),document.addEventListener("WeixinJSBridgeReady",function(){k.play()},!1),j&&j.loop&&"off"===j.loop&&k.removeAttribute("loop"),k.addEventListener("canplaythrough",function(){k.play()},!1),d.on("click",function(){d.hide(),c.show(),k.play()}),c.on("click",function(){d.show(),c.hide(),k.pause()})}else d.hide(),c.hide();g.bind("click",function(){var e=u.turn("page");e>=2&&(u.turn("page",e-1),f.hasClass("active")||f.addClass("active"),2===e&&(g.removeClass("active"),v.removeClass("active")))}),f.bind("click",function(){var e=u.turn("page");e<i.pageNum&&(u.turn("page",e+1),g.addClass("active"),v.addClass("active"),e>=i.pageNum-1&&f.removeClass("active"))}),v.bind("click",function(){var e=u.turn("page");1!==e&&(u.turn("page",1),v.removeClass("active"),f.addClass("active"),g.removeClass("active"))})},setMusic:function(e){if(i.audio)switch(e){case"on":i.audio.paused&&(i.audio.play(),d.hide(),c.show());break;case"off":i.audio.paused||(i.audio.pause(),d.hide(),c.hide())}}},new t});