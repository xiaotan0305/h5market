/*angular-picker.js*/
angular.module("ngPicky",[]).directive("picker",["Color",function(t){return{restrict:"EA",scope:{color:"=",pick:"&"},controller:["$scope",function(t){t.hue=0,t.color=t.$parent.$parent.colorPanelDefault,"white"==t.color?t.color="#ffffff":"black"==t.color&&(t.color="#000000");var e=!1;t.selectColor=function(n,i){var r=i?n:n.toHex();return e||"#ffffff"!=r?(t.color=r,t.$emit("changeColor",t.color),void t.pick({$color:n})):void(e=!0)},t.selectColor(t.color,!0),t.$on("changeColor2",function(e,n){n&&t.selectColor(n,!0)})}],template:"<div class='picker' style='padding:0.5em; width:300px;'>       <div class='picker-wrapper'>         <color-space hue='hue' pick='selectColor($color)'></color-space>         <hue-space hue='hue'></hue-space>       </div>       <converters color='color'></converters>     </div>"}}]).directive("colorSpace",["Widgets","Color","ConvertColor","PickerUtils","ColorCache",function(t,e,n,i,r){return{restrict:"E",replace:!0,scope:{hue:"=",pick:"&"},template:"<section class='picker-colorspace'></section>",link:function(n,o){var s=t.canvas(),a=s.canvas,l=s.context,c=t.cursor("&#9675;");n.$watch("hue",function(){n.repaint(),n.select()}),n.select=function(){var t,r,o;t=i.stripPx(c.element.style.left),r=i.stripPx(c.element.style.top),o=l.getImageData(t,r,1,1).data,n.pick({$color:e.create(o[0],o[1],o[2])})},n.moveCursor=function(t){var e=this.getBoundingClientRect(),i=t.pageX-e.left,r=t.pageY-e.top;c.element.style.left=i+"px",c.element.style.top=r+"px",n.select(),n.$apply()},n.mouseMove=function(t){n.mousedown&&n.moveCursor.call(this,t)},n.mouseToggle=function(t){n.mousedown=t},n.resize=function(){a.width=a.height=o.prop("offsetWidth")},n.repaint=function(){var t=r.get(n.hue);t?l.putImageData(t,0,0):(n.paint(),t=l.getImageData(0,0,a.width,a.height),r.set(n.hue,t))},n.paint=function(){var t,e,i,r,o;for(t=n.hue,e=0,i=0,r=0;r<a.height;r++)i=100-r/a.height*100,o=l.createLinearGradient(0,0,a.width,0),o.addColorStop(0,"hsl("+t+", 0%, "+i+"%)"),o.addColorStop(1,"hsl("+t+", 100%, "+i+"%)"),l.fillStyle=o,l.fillRect(0,r,a.width,1)},n.resize(),n.mousedown=!1,n.paint(),o.append(a),o.append(c.element),a.addEventListener("mouseup",n.mouseToggle.bind(null,!1)),a.addEventListener("mousedown",n.mouseToggle.bind(null,!0)),a.addEventListener("mousemove",n.mouseMove),a.addEventListener("click",n.moveCursor)}}}]).directive("hueSpace",["Widgets","PickerUtils",function(t,e){return{restrict:"E",replace:!0,scope:{hue:"=",pick:"&"},template:"<aside class='picker-huespace'></aside>",link:function(n,i){var r=t.canvas(),o=r.canvas,s=r.context,a=t.cursor("&#9654;");n.select=function(){var t=e.stripPx(a.element.style.top);n.hue=Math.round(t/o.height*360),n.$apply()},n.moveCursor=function(t){var e=this.getBoundingClientRect(),i=t.pageY-e.top;a.element.style.top=i+"px",n.select(),n.$apply()},n.mouseMove=function(t){n.mousedown&&n.moveCursor.call(this,t)},n.mouseToggle=function(t){n.mousedown=t},n.resize=function(){o.width=i.prop("offsetWidth"),o.height=i.prop("offsetHeight")},n.paint=function(){var t=0;for(y=0;y<o.height;y++)t=y/o.height*360,s.fillStyle="hsl("+t+", 100%, 50%)",s.fillRect(0,y,o.width,1)},n.resize(),n.mousedown=!1,n.paint(),i.append(o),i.append(a.element),o.addEventListener("mouseup",n.mouseToggle.bind(null,!1)),o.addEventListener("mousedown",n.mouseToggle.bind(null,!0)),o.addEventListener("mousemove",n.mouseMove),o.addEventListener("click",n.moveCursor)}}}]).directive("converters",function(){return{restrict:"E",scope:{color:"="},controller:["$scope",function(t){$("input").on("keydown",function(e){if(13==e.keyCode){var n=e.target.value;0==n.indexOf("#")&&7==n.length&&(t.$emit("changeColor",n),t.$parent.$parent.closeColorBoard())}})}],template:"<section class='picker-input'>       <div class='picker-row'>         <span class='picker-prefix'>#</span>         <input type='text'                 ng-value='color'/>       </div>     </section>"}}).filter("toHex",["Color",function(t){return function(e){return e||(e=t["default"]()),e.toHex()}}]).filter("toUnprefixedHex",function(){return function(t){return t.toUnprefixedHex()}}).filter("toRGB",function(){return function(t){return["rgb(",t.toRGB().join(","),")"].join("")}}).filter("toHSL",function(){return function(t){return["hsl(",t.toHSL().join(","),")"].join("")}}).service("Color",["Hex",function(t){function e(t,e,n){this.r=t,this.g=e,this.b=n}e.prototype.toRGB=function(){return[this.r,this.g,this.b]},e.prototype.toHex=function(){return"#"+this.toUnprefixedHex()},e.prototype.toUnprefixedHex=function(){return this.toRGB().map(this.decToHex).join("")},e.prototype.toHSL=function(){var t,e,n,i,r,o,s,a,l,c,u;return t=this.r/255,e=this.g/255,n=this.b/255,i=Math.min(t,e,n),r=Math.max(t,e,n),l=r-i,a=(r+i)/2,0===l?(o=0,s=0):.5>a?s=l/(r+i):(s=l/(2-r-i),c=((r-t)/6+l/2)/l,u=((r-e)/6+l/2)/l,db=((r-n)/6+l/2)/l,o=t===r?db-u:e===r?1/3+c-db:2/3+u-c,0>o&&(o+=1),o>1&&(o-=1)),[360*o,s,a]},e.prototype.decToHex=function(e){return t.pad(e.toString(16))},this.create=function(t,n,i){return new e(t,n,i)},this["default"]=function(){return new e(255,255,255)}}]).service("ConvertColor",["Color","Hex",function(t,e){this.fromRGB=function(e,n,i){return t.create(e,n,i)},this.fromHex=function(n){var i=e.normalize(n),r=[],o=null,s=0;for(s=0;6>s;s+=2)o=i.slice(s,s+2),r.push(parseInt(o,16));return t.create.apply(null,r)},this.fromHSL=function(e,n,i){var r,o,s,a;return r=(1-Math.abs(2*i-1))*n,o=e/60,s=r*(1-Math.abs(o%2-1)),o>=0&&1>o&&(a=[r,s,0]),o>=1&&2>o&&(a=[s,r,0]),o>=2&&3>o&&(a=[0,r,s]),o>=3&&4>o&&(a=[0,s,r]),o>=4&&5>o&&(a=[s,0,r]),o>=5&&6>o&&(a=[r,0,s]),m=i-r/2,t.create.apply(null,a.map(function(t){return t+m}))}}]).service("Hex",function(){this.validator=new RegExp(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/),this.validate=function(t){var e=t.match(this.validator);return e?e.pop():null},this.pad=function(t){return("00"+t).slice(-2)},this.normalize=function(t){function e(t,e){t.concat(e)}function n(t){return[t,t]}var i=this.validate(t);return 3===i.length?i.split("").map(n).reduce(e,[]).join(""):i}}).service("Widgets",function(){this.cursor=function(t){var e=document.createElement("div");return e.innerHTML=t,e.setAttribute("class","picker-cursor"),e.style.position="absolute",e.style.top=0,e.style.left=0,{element:e,x:0,y:0}},this.canvas=function(){var t=document.createElement("canvas"),e=t.getContext("2d");return{canvas:t,context:e}}}).service("ColorCache",function(){var t={};this.get=function(e){return t[e]},this.set=function(e,n){t[e]||(t[e]=n)}}).service("PickerUtils",function(){this.stripPx=function(t){return t.slice(0,t.length-2)}}),function(t){"function"==typeof define&&define.amd?define("picker",["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):this.Picker=t(jQuery)}(function(t){function e(o,s,l,d){function p(){return e._.node("div",e._.node("div",e._.node("div",e._.node("div",D.component.nodes($.open),k.box),k.wrap),k.frame),k.holder,'tabindex="-1"')}function f(){C.data(s,D).addClass(k.input).val(C.data("value")?D.get("select",_.format):o.value),_.editable||C.on("focus."+$.id+" click."+$.id,function(t){t.preventDefault(),D.open()}).on("keydown."+$.id,w),r(o,{haspopup:!0,expanded:!1,readonly:!1,owns:o.id+"_root"})}function m(){r(D.$root[0],"hidden",!0)}function g(){D.$holder.on({keydown:w,"focus.toOpen":b,blur:function(){C.removeClass(k.target)},focusin:function(t){D.$root.removeClass(k.focused),t.stopPropagation()},"mousedown click":function(e){var n=e.target;n!=D.$holder[0]&&(e.stopPropagation(),"mousedown"!=e.type||t(n).is("input, select, textarea, button, option")||(e.preventDefault(),D.$holder[0].focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var e=t(this),n=e.data(),i=e.hasClass(k.navDisabled)||e.hasClass(k.disabled),r=a();r=r&&(r.type||r.href),(i||r&&!t.contains(D.$root[0],r))&&D.$holder[0].focus(),!i&&n.nav?D.set("highlight",D.component.item.highlight,{nav:n.nav}):!i&&"pick"in n?(D.set("select",n.pick),_.closeOnSelect&&D.close(!0)):n.clear?(D.clear(),_.closeOnClear&&D.close(!0)):n.close&&D.close(!0)})}function v(){var e;_.hiddenName===!0?(e=o.name,o.name=""):(e=["string"==typeof _.hiddenPrefix?_.hiddenPrefix:"","string"==typeof _.hiddenSuffix?_.hiddenSuffix:"_submit"],e=e[0]+o.name+e[1]),D._hidden=t('<input type=hidden name="'+e+'"'+(C.data("value")||o.value?' value="'+D.get("select",_.formatSubmit)+'"':"")+">")[0],C.on("change."+$.id,function(){D._hidden.value=o.value?D.get("select",_.formatSubmit):""})}function y(){x&&h?D.$holder.find("."+k.frame).one("transitionend",function(){D.$holder[0].focus()}):D.$holder[0].focus()}function b(t){t.stopPropagation(),C.addClass(k.target),D.$root.addClass(k.focused),D.open()}function w(t){var e=t.keyCode,n=/^(8|46)$/.test(e);return 27==e?(D.close(!0),!1):void((32==e||n||!$.open&&D.component.key[e])&&(t.preventDefault(),t.stopPropagation(),n?D.clear().close():D.open()))}if(!o)return e;var x=!1,$={id:o.id||"P"+Math.abs(~~(Math.random()*new Date))},_=l?t.extend(!0,{},l.defaults,d):d||{},k=t.extend({},e.klasses(),_.klass),C=t(o),T=function(){return this.start()},D=T.prototype={constructor:T,$node:C,start:function(){return $&&$.start?D:($.methods={},$.start=!0,$.open=!1,$.type=o.type,o.autofocus=o==a(),o.readOnly=!_.editable,o.id=o.id||$.id,"text"!=o.type&&(o.type="text"),D.component=new l(D,_),D.$root=t('<div class="'+k.picker+'" id="'+o.id+'_root" />'),m(),D.$holder=t(p()).appendTo(D.$root),g(),_.formatSubmit&&v(),f(),_.containerHidden?t(_.containerHidden).append(D._hidden):C.after(D._hidden),_.container?t(_.container).append(D.$root):C.after(D.$root),D.on({start:D.component.onStart,render:D.component.onRender,stop:D.component.onStop,open:D.component.onOpen,close:D.component.onClose,set:D.component.onSet}).on({start:_.onStart,render:_.onRender,stop:_.onStop,open:_.onOpen,close:_.onClose,set:_.onSet}),x=n(D.$holder[0]),o.autofocus&&D.open(),D.trigger("start").trigger("render"))},render:function(e){return e?(D.$holder=t(p()),g(),D.$root.html(D.$holder)):D.$root.find("."+k.box).html(D.component.nodes($.open)),D.trigger("render")},stop:function(){return $.start?(D.close(),D._hidden&&D._hidden.parentNode.removeChild(D._hidden),D.$root.remove(),C.removeClass(k.input).removeData(s),setTimeout(function(){C.off("."+$.id)},0),o.type=$.type,o.readOnly=!1,D.trigger("stop"),$.methods={},$.start=!1,D):D},open:function(n){return $.open?D:(C.addClass(k.active),r(o,"expanded",!0),setTimeout(function(){D.$root.addClass(k.opened),r(D.$root[0],"hidden",!1)},0),n!==!1&&($.open=!0,x&&u.css("overflow","hidden").css("padding-right","+="+i()),y(),c.on("click."+$.id+" focusin."+$.id,function(t){var e=t.target;e!=o&&e!=document&&3!=t.which&&D.close(e===D.$holder[0])}).on("keydown."+$.id,function(n){var i=n.keyCode,r=D.component.key[i],o=n.target;27==i?D.close(!0):o!=D.$holder[0]||!r&&13!=i?t.contains(D.$root[0],o)&&13==i&&(n.preventDefault(),o.click()):(n.preventDefault(),r?e._.trigger(D.component.key.go,D,[e._.trigger(r)]):D.$root.find("."+k.highlighted).hasClass(k.disabled)||(D.set("select",D.component.item.highlight),_.closeOnSelect&&D.close(!0)))})),D.trigger("open"))},close:function(t){return t&&(_.editable?o.focus():(D.$holder.off("focus.toOpen").focus(),setTimeout(function(){D.$holder.on("focus.toOpen",b)},0))),C.removeClass(k.active),r(o,"expanded",!1),setTimeout(function(){D.$root.removeClass(k.opened+" "+k.focused),r(D.$root[0],"hidden",!0)},0),$.open?($.open=!1,x&&u.css("overflow","").css("padding-right","-="+i()),c.off("."+$.id),D.trigger("close")):D},clear:function(t){return D.set("clear",null,t)},set:function(e,n,i){var r,o,s=t.isPlainObject(e),a=s?e:{};if(i=s&&t.isPlainObject(n)?n:i||{},e){s||(a[e]=n);for(r in a)o=a[r],r in D.component.item&&(void 0===o&&(o=null),D.component.set(r,o,i)),("select"==r||"clear"==r)&&C.val("clear"==r?"":D.get(r,_.format)).trigger("change");D.render()}return i.muted?D:D.trigger("set",a)},get:function(t,n){if(t=t||"value",null!=$[t])return $[t];if("valueSubmit"==t){if(D._hidden)return D._hidden.value;t="value"}if("value"==t)return o.value;if(t in D.component.item){if("string"==typeof n){var i=D.component.get(t);return i?e._.trigger(D.component.formats.toString,D.component,[n,i]):""}return D.component.get(t)}},on:function(e,n,i){var r,o,s=t.isPlainObject(e),a=s?e:{};if(e){s||(a[e]=n);for(r in a)o=a[r],i&&(r="_"+r),$.methods[r]=$.methods[r]||[],$.methods[r].push(o);
}return D},off:function(){var t,e,n=arguments;for(t=0,namesCount=n.length;t<namesCount;t+=1)e=n[t],e in $.methods&&delete $.methods[e];return D},trigger:function(t,n){var i=function(t){var i=$.methods[t];i&&i.map(function(t){e._.trigger(t,D,[n])})};return i("_"+t),i(t),D}};return new T}function n(t){var e,n="position";return t.currentStyle?e=t.currentStyle[n]:window.getComputedStyle&&(e=getComputedStyle(t)[n]),"fixed"==e}function i(){if(u.height()<=l.height())return 0;var e=t('<div style="visibility:hidden;width:100px" />').appendTo("body"),n=e[0].offsetWidth;e.css("overflow","scroll");var i=t('<div style="width:100%" />').appendTo(e),r=i[0].offsetWidth;return e.remove(),n-r}function r(e,n,i){if(t.isPlainObject(n))for(var r in n)o(e,r,n[r]);else o(e,n,i)}function o(t,e,n){t.setAttribute(("role"==e?"":"aria-")+e,n)}function s(e,n){t.isPlainObject(e)||(e={attribute:n}),n="";for(var i in e){var r=("role"==i?"":"aria-")+i,o=e[i];n+=null==o?"":r+'="'+e[i]+'"'}return n}function a(){try{return document.activeElement}catch(t){}}var l=t(window),c=t(document),u=t(document.documentElement),h=null!=document.documentElement.style.transition;return e.klasses=function(t){return t=t||"picker",{picker:t,opened:t+"--opened",focused:t+"--focused",input:t+"__input",active:t+"__input--active",target:t+"__input--target",holder:t+"__holder",frame:t+"__frame",wrap:t+"__wrap",box:t+"__box"}},e._={group:function(t){for(var n,i="",r=e._.trigger(t.min,t);r<=e._.trigger(t.max,t,[r]);r+=t.i)n=e._.trigger(t.item,t,[r]),i+=e._.node(t.node,n[0],n[1],n[2]);return i},node:function(e,n,i,r){return n?(n=t.isArray(n)?n.join(""):n,i=i?' class="'+i+'"':"",r=r?" "+r:"","<"+e+i+r+">"+n+"</"+e+">"):""},lead:function(t){return(10>t?"0":"")+t},trigger:function(t,e,n){return"function"==typeof t?t.apply(e,n||[]):t},digits:function(t){return/\d/.test(t[1])?2:1},isDate:function(t){return{}.toString.call(t).indexOf("Date")>-1&&this.isInteger(t.getDate())},isInteger:function(t){return{}.toString.call(t).indexOf("Number")>-1&&t%1===0},ariaAttr:s},e.extend=function(n,i){t.fn[n]=function(r,o){var s=this.data(n);return"picker"==r?s:s&&"string"==typeof r?e._.trigger(s[r],s,[o]):this.each(function(){var o=t(this);o.data(n)||new e(this,n,i,r)})},t.fn[n].defaults=i.defaults},e}),function(t){"function"==typeof define&&define.amd?define(["picker","jquery"],t):"object"==typeof exports?module.exports=t(require("./picker.js"),require("jquery")):t(Picker,jQuery)}(function(t,e){function n(t,e){var n=this,i=t.$node[0],r=i.value,o=t.$node.data("value"),s=o||r,a=o?e.formatSubmit:e.format,l=function(){return i.currentStyle?"rtl"==i.currentStyle.direction:"rtl"==getComputedStyle(t.$root[0]).direction};n.settings=e,n.$node=t.$node,n.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},n.item={},n.item.clear=null,n.item.disable=(e.disable||[]).slice(0),n.item.enable=-function(t){return t[0]===!0?t.shift():-1}(n.item.disable),n.set("min",e.min).set("max",e.max).set("now"),s?n.set("select",s,{format:a,defaultValue:!0}):n.set("select",null).set("highlight",n.item.now),n.key={40:7,38:-7,39:function(){return l()?-1:1},37:function(){return l()?1:-1},go:function(t){var e=n.item.highlight,i=new Date(e.year,e.month,e.date+t);n.set("highlight",i,{interval:t}),this.render()}},t.on("render",function(){t.$root.find("."+e.klass.selectMonth).on("change",function(){var n=this.value;n&&(t.set("highlight",[t.get("view").year,n,t.get("highlight").date]),t.$root.find("."+e.klass.selectMonth).trigger("focus"))}),t.$root.find("."+e.klass.selectYear).on("change",function(){var n=this.value;n&&(t.set("highlight",[n,t.get("view").month,t.get("highlight").date]),t.$root.find("."+e.klass.selectYear).trigger("focus"))})},1).on("open",function(){var i="";n.disabled(n.get("now"))&&(i=":not(."+e.klass.buttonToday+")"),t.$root.find("button"+i+", select").attr("disabled",!1)},1).on("close",function(){t.$root.find("button, select").attr("disabled",!0)},1)}var i=7,r=6,o=t._;n.prototype.set=function(t,e,n){var i=this,r=i.item;return null===e?("clear"==t&&(t="select"),r[t]=e,i):(r["enable"==t?"disable":"flip"==t?"enable":t]=i.queue[t].split(" ").map(function(r){return e=i[r](t,e,n)}).pop(),"select"==t?i.set("highlight",r.select,n):"highlight"==t?i.set("view",r.highlight,n):t.match(/^(flip|min|max|disable|enable)$/)&&(r.select&&i.disabled(r.select)&&i.set("select",r.select,n),r.highlight&&i.disabled(r.highlight)&&i.set("highlight",r.highlight,n)),i)},n.prototype.get=function(t){return this.item[t]},n.prototype.create=function(t,n,i){var r,s=this;return n=void 0===n?t:n,n==-(1/0)||n==1/0?r=n:e.isPlainObject(n)&&o.isInteger(n.pick)?n=n.obj:e.isArray(n)?(n=new Date(n[0],n[1],n[2]),n=o.isDate(n)?n:s.create().obj):n=o.isInteger(n)||o.isDate(n)?s.normalize(new Date(n),i):s.now(t,n,i),{year:r||n.getFullYear(),month:r||n.getMonth(),date:r||n.getDate(),day:r||n.getDay(),obj:r||n,pick:r||n.getTime()}},n.prototype.createRange=function(t,n){var i=this,r=function(t){return t===!0||e.isArray(t)||o.isDate(t)?i.create(t):t};return o.isInteger(t)||(t=r(t)),o.isInteger(n)||(n=r(n)),o.isInteger(t)&&e.isPlainObject(n)?t=[n.year,n.month,n.date+t]:o.isInteger(n)&&e.isPlainObject(t)&&(n=[t.year,t.month,t.date+n]),{from:r(t),to:r(n)}},n.prototype.withinRange=function(t,e){return t=this.createRange(t.from,t.to),e.pick>=t.from.pick&&e.pick<=t.to.pick},n.prototype.overlapRanges=function(t,e){var n=this;return t=n.createRange(t.from,t.to),e=n.createRange(e.from,e.to),n.withinRange(t,e.from)||n.withinRange(t,e.to)||n.withinRange(e,t.from)||n.withinRange(e,t.to)},n.prototype.now=function(t,e,n){return e=new Date,n&&n.rel&&e.setDate(e.getDate()+n.rel),this.normalize(e,n)},n.prototype.navigate=function(t,n,i){var r,o,s,a,l=e.isArray(n),c=e.isPlainObject(n),u=this.item.view;if(l||c){for(c?(o=n.year,s=n.month,a=n.date):(o=+n[0],s=+n[1],a=+n[2]),i&&i.nav&&u&&u.month!==s&&(o=u.year,s=u.month),r=new Date(o,s+(i&&i.nav?i.nav:0),1),o=r.getFullYear(),s=r.getMonth();new Date(o,s,a).getMonth()!==s;)a-=1;n=[o,s,a]}return n},n.prototype.normalize=function(t){return t.setHours(0,0,0,0),t},n.prototype.measure=function(t,e){var n=this;return e?"string"==typeof e?e=n.parse(t,e):o.isInteger(e)&&(e=n.now(t,e,{rel:e})):e="min"==t?-(1/0):1/0,e},n.prototype.viewset=function(t,e){return this.create([e.year,e.month,1])},n.prototype.validate=function(t,n,i){var r,s,a,l,c=this,u=n,h=i&&i.interval?i.interval:1,d=-1===c.item.enable,p=c.item.min,f=c.item.max,m=d&&c.item.disable.filter(function(t){if(e.isArray(t)){var i=c.create(t).pick;i<n.pick?r=!0:i>n.pick&&(s=!0)}return o.isInteger(t)}).length;if((!i||!i.nav&&!i.defaultValue)&&(!d&&c.disabled(n)||d&&c.disabled(n)&&(m||r||s)||!d&&(n.pick<=p.pick||n.pick>=f.pick)))for(d&&!m&&(!s&&h>0||!r&&0>h)&&(h*=-1);c.disabled(n)&&(Math.abs(h)>1&&(n.month<u.month||n.month>u.month)&&(n=u,h=h>0?1:-1),n.pick<=p.pick?(a=!0,h=1,n=c.create([p.year,p.month,p.date+(n.pick===p.pick?0:-1)])):n.pick>=f.pick&&(l=!0,h=-1,n=c.create([f.year,f.month,f.date+(n.pick===f.pick?0:1)])),!a||!l);)n=c.create([n.year,n.month,n.date+h]);return n},n.prototype.disabled=function(t){var n=this,i=n.item.disable.filter(function(i){return o.isInteger(i)?t.day===(n.settings.firstDay?i:i-1)%7:e.isArray(i)||o.isDate(i)?t.pick===n.create(i).pick:e.isPlainObject(i)?n.withinRange(i,t):void 0});return i=i.length&&!i.filter(function(t){return e.isArray(t)&&"inverted"==t[3]||e.isPlainObject(t)&&t.inverted}).length,-1===n.item.enable?!i:i||t.pick<n.item.min.pick||t.pick>n.item.max.pick},n.prototype.parse=function(t,e,n){var i=this,r={};return e&&"string"==typeof e?(n&&n.format||(n=n||{},n.format=i.settings.format),i.formats.toArray(n.format).map(function(t){var n=i.formats[t],s=n?o.trigger(n,i,[e,r]):t.replace(/^!/,"").length;n&&(r[t]=e.substr(0,s)),e=e.substr(s)}),[r.yyyy||r.yy,+(r.mm||r.m)-1,r.dd||r.d]):e},n.prototype.formats=function(){function t(t,e,n){var i=t.match(/[^\x00-\x7F]+|\w+/)[0];return n.mm||n.m||(n.m=e.indexOf(i)+1),i.length}function e(t){return t.match(/\w+/)[0].length}return{d:function(t,e){return t?o.digits(t):e.date},dd:function(t,e){return t?2:o.lead(e.date)},ddd:function(t,n){return t?e(t):this.settings.weekdaysShort[n.day]},dddd:function(t,n){return t?e(t):this.settings.weekdaysFull[n.day]},m:function(t,e){return t?o.digits(t):e.month+1},mm:function(t,e){return t?2:o.lead(e.month+1)},mmm:function(e,n){var i=this.settings.monthsShort;return e?t(e,i,n):i[n.month]},mmmm:function(e,n){var i=this.settings.monthsFull;return e?t(e,i,n):i[n.month]},yy:function(t,e){return t?2:(""+e.year).slice(2)},yyyy:function(t,e){return t?4:e.year},toArray:function(t){return t.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(t,e){var n=this;return n.formats.toArray(t).map(function(t){return o.trigger(n.formats[t],n,[0,e])||t.replace(/^!/,"")}).join("")}}}(),n.prototype.isDateExact=function(t,n){var i=this;return o.isInteger(t)&&o.isInteger(n)||"boolean"==typeof t&&"boolean"==typeof n?t===n:(o.isDate(t)||e.isArray(t))&&(o.isDate(n)||e.isArray(n))?i.create(t).pick===i.create(n).pick:e.isPlainObject(t)&&e.isPlainObject(n)?i.isDateExact(t.from,n.from)&&i.isDateExact(t.to,n.to):!1},n.prototype.isDateOverlap=function(t,n){var i=this,r=i.settings.firstDay?1:0;return o.isInteger(t)&&(o.isDate(n)||e.isArray(n))?(t=t%7+r,t===i.create(n).day+1):o.isInteger(n)&&(o.isDate(t)||e.isArray(t))?(n=n%7+r,n===i.create(t).day+1):e.isPlainObject(t)&&e.isPlainObject(n)?i.overlapRanges(t,n):!1},n.prototype.flipEnable=function(t){var e=this.item;e.enable=t||(-1==e.enable?1:-1)},n.prototype.deactivate=function(t,n){var i=this,r=i.item.disable.slice(0);return"flip"==n?i.flipEnable():n===!1?(i.flipEnable(1),r=[]):n===!0?(i.flipEnable(-1),r=[]):n.map(function(t){for(var n,s=0;s<r.length;s+=1)if(i.isDateExact(t,r[s])){n=!0;break}n||(o.isInteger(t)||o.isDate(t)||e.isArray(t)||e.isPlainObject(t)&&t.from&&t.to)&&r.push(t)}),r},n.prototype.activate=function(t,n){var i=this,r=i.item.disable,s=r.length;return"flip"==n?i.flipEnable():n===!0?(i.flipEnable(1),r=[]):n===!1?(i.flipEnable(-1),r=[]):n.map(function(t){var n,a,l,c;for(l=0;s>l;l+=1){if(a=r[l],i.isDateExact(a,t)){n=r[l]=null,c=!0;break}if(i.isDateOverlap(a,t)){e.isPlainObject(t)?(t.inverted=!0,n=t):e.isArray(t)?(n=t,n[3]||n.push("inverted")):o.isDate(t)&&(n=[t.getFullYear(),t.getMonth(),t.getDate(),"inverted"]);break}}if(n)for(l=0;s>l;l+=1)if(i.isDateExact(r[l],t)){r[l]=null;break}if(c)for(l=0;s>l;l+=1)if(i.isDateOverlap(r[l],t)){r[l]=null;break}n&&r.push(n)}),r.filter(function(t){return null!=t})},n.prototype.nodes=function(t){var e=this,n=e.settings,s=e.item,a=s.now,l=s.select,c=s.highlight,u=s.view,h=s.disable,d=s.min,p=s.max,f=function(t,e){return n.firstDay&&(t.push(t.shift()),e.push(e.shift())),o.node("thead",o.node("tr",o.group({min:0,max:i-1,i:1,node:"th",item:function(i){return[t[i],n.klass.weekdays,'scope=col title="'+e[i]+'"']}})))}((n.showWeekdaysFull?n.weekdaysFull:n.weekdaysShort).slice(0),n.weekdaysFull.slice(0)),m=function(t){return o.node("div"," ",n.klass["nav"+(t?"Next":"Prev")]+(t&&u.year>=p.year&&u.month>=p.month||!t&&u.year<=d.year&&u.month<=d.month?" "+n.klass.navDisabled:""),"data-nav="+(t||-1)+" "+o.ariaAttr({role:"button",controls:e.$node[0].id+"_table"})+' title="'+(t?n.labelMonthNext:n.labelMonthPrev)+'"')},g=function(){var i=n.showMonthsShort?n.monthsShort:n.monthsFull;return n.selectMonths?o.node("select",o.group({min:0,max:11,i:1,node:"option",item:function(t){return[i[t],0,"value="+t+(u.month==t?" selected":"")+(u.year==d.year&&t<d.month||u.year==p.year&&t>p.month?" disabled":"")]}}),n.klass.selectMonth,(t?"":"disabled")+" "+o.ariaAttr({controls:e.$node[0].id+"_table"})+' title="'+n.labelMonthSelect+'"'):o.node("div",i[u.month],n.klass.month)},v=function(){var i=u.year,r=n.selectYears===!0?5:~~(n.selectYears/2);if(r){var s=d.year,a=p.year,l=i-r,c=i+r;if(s>l&&(c+=s-l,l=s),c>a){var h=l-s,f=c-a;l-=h>f?f:h,c=a}return o.node("select",o.group({min:l,max:c,i:1,node:"option",item:function(t){return[t,0,"value="+t+(i==t?" selected":"")]}}),n.klass.selectYear,(t?"":"disabled")+" "+o.ariaAttr({controls:e.$node[0].id+"_table"})+' title="'+n.labelYearSelect+'"')}return o.node("div",i,n.klass.year)};return o.node("div",(n.selectYears?v()+g():g()+v())+m()+m(1),n.klass.header)+o.node("table",f+o.node("tbody",o.group({min:0,max:r-1,i:1,node:"tr",item:function(t){var r=n.firstDay&&0===e.create([u.year,u.month,1]).day?-7:0;return[o.group({min:i*t-u.day+r+1,max:function(){return this.min+i-1},i:1,node:"td",item:function(t){t=e.create([u.year,u.month,t+(n.firstDay?1:0)]);var i=l&&l.pick==t.pick,r=c&&c.pick==t.pick,s=h&&e.disabled(t)||t.pick<d.pick||t.pick>p.pick,f=o.trigger(e.formats.toString,e,[n.format,t]);return[o.node("div",t.date,function(e){return e.push(u.month==t.month?n.klass.infocus:n.klass.outfocus),a.pick==t.pick&&e.push(n.klass.now),i&&e.push(n.klass.selected),r&&e.push(n.klass.highlighted),s&&e.push(n.klass.disabled),e.join(" ")}([n.klass.day]),"data-pick="+t.pick+" "+o.ariaAttr({role:"gridcell",label:f,selected:i&&e.$node.val()===f?!0:null,activedescendant:r?!0:null,disabled:s?!0:null})),"",o.ariaAttr({role:"presentation"})]}})]}})),n.klass.table,'id="'+e.$node[0].id+'_table" '+o.ariaAttr({role:"grid",controls:e.$node[0].id,readonly:!0}))+o.node("div",o.node("button",n.today,n.klass.buttonToday,"type=button data-pick="+a.pick+(t&&!e.disabled(a)?"":" disabled")+" "+o.ariaAttr({controls:e.$node[0].id}))+o.node("button",n.clear,n.klass.buttonClear,"type=button data-clear=1"+(t?"":" disabled")+" "+o.ariaAttr({controls:e.$node[0].id}))+o.node("button",n.close,n.klass.buttonClose,"type=button data-close=true "+(t?"":" disabled")+" "+o.ariaAttr({controls:e.$node[0].id})),n.klass.footer)},n.defaults=function(t){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:!0,closeOnClear:!0,format:"d mmmm, yyyy",klass:{table:t+"table",header:t+"header",navPrev:t+"nav--prev",navNext:t+"nav--next",navDisabled:t+"nav--disabled",month:t+"month",year:t+"year",selectMonth:t+"select--month",selectYear:t+"select--year",weekdays:t+"weekday",day:t+"day",disabled:t+"day--disabled",selected:t+"day--selected",highlighted:t+"day--highlighted",now:t+"day--today",infocus:t+"day--infocus",outfocus:t+"day--outfocus",footer:t+"footer",buttonClear:t+"button--clear",buttonToday:t+"button--today",buttonClose:t+"button--close"}}}(t.klasses().picker+"__"),t.extend("pickadate",n)}),function(t){"function"==typeof define&&define.amd?define(["picker","jquery"],t):"object"==typeof exports?module.exports=t(require("./picker.js"),require("jquery")):t(Picker,jQuery)}(function(t,e){function n(t,e){var n=this,i=t.$node[0].value,r=t.$node.data("value"),o=r||i,s=r?e.formatSubmit:e.format;n.settings=e,n.$node=t.$node,n.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"},n.item={},n.item.clear=null,n.item.interval=e.interval||30,n.item.disable=(e.disable||[]).slice(0),n.item.enable=-function(t){return t[0]===!0?t.shift():-1}(n.item.disable),n.set("min",e.min).set("max",e.max).set("now"),o?n.set("select",o,{format:s}):n.set("select",null).set("highlight",n.item.now),n.key={40:1,38:-1,39:1,37:-1,go:function(t){n.set("highlight",n.item.highlight.pick+t*n.item.interval,{interval:t*n.item.interval}),this.render()}},t.on("render",function(){var n=t.$root.children(),i=n.find("."+e.klass.viewset),r=function(t){return["webkit","moz","ms","o",""].map(function(e){return(e?"-"+e+"-":"")+t})},o=function(t,e){r("transform").map(function(n){t.css(n,e)}),r("transition").map(function(n){t.css(n,e)})};i.length&&(o(n,"none"),n[0].scrollTop=~~i.position().top-2*i[0].clientHeight,o(n,""))},1).on("open",function(){t.$root.find("button").attr("disabled",!1)},1).on("close",function(){t.$root.find("button").attr("disabled",!0)},1)}var i=24,r=60,o=12,s=i*r,a=t._;n.prototype.set=function(t,e,n){var i=this,r=i.item;return null===e?("clear"==t&&(t="select"),r[t]=e,i):(r["enable"==t?"disable":"flip"==t?"enable":t]=i.queue[t].split(" ").map(function(r){return e=i[r](t,e,n)}).pop(),"select"==t?i.set("highlight",r.select,n):"highlight"==t?i.set("view",r.highlight,n):"interval"==t?i.set("min",r.min,n).set("max",r.max,n):t.match(/^(flip|min|max|disable|enable)$/)&&(r.select&&i.disabled(r.select)&&i.set("select",e,n),r.highlight&&i.disabled(r.highlight)&&i.set("highlight",e,n),"min"==t&&i.set("max",r.max,n)),i)},n.prototype.get=function(t){return this.item[t]},n.prototype.create=function(t,n,o){var l=this;return n=void 0===n?t:n,a.isDate(n)&&(n=[n.getHours(),n.getMinutes()]),e.isPlainObject(n)&&a.isInteger(n.pick)?n=n.pick:e.isArray(n)?n=+n[0]*r+ +n[1]:a.isInteger(n)||(n=l.now(t,n,o)),"max"==t&&n<l.item.min.pick&&(n+=s),"min"!=t&&"max"!=t&&(n-l.item.min.pick)%l.item.interval!==0&&(n+=l.item.interval),n=l.normalize(t,n,o),{hour:~~(i+n/r)%i,mins:(r+n%r)%r,time:(s+n)%s,pick:n%s}},n.prototype.createRange=function(t,n){var i=this,r=function(t){return t===!0||e.isArray(t)||a.isDate(t)?i.create(t):t};return a.isInteger(t)||(t=r(t)),a.isInteger(n)||(n=r(n)),a.isInteger(t)&&e.isPlainObject(n)?t=[n.hour,n.mins+t*i.settings.interval]:a.isInteger(n)&&e.isPlainObject(t)&&(n=[t.hour,t.mins+n*i.settings.interval]),{from:r(t),to:r(n)}},n.prototype.withinRange=function(t,e){return t=this.createRange(t.from,t.to),e.pick>=t.from.pick&&e.pick<=t.to.pick},n.prototype.overlapRanges=function(t,e){var n=this;return t=n.createRange(t.from,t.to),e=n.createRange(e.from,e.to),n.withinRange(t,e.from)||n.withinRange(t,e.to)||n.withinRange(e,t.from)||n.withinRange(e,t.to)},n.prototype.now=function(t,e){var n,i=this.item.interval,o=new Date,s=o.getHours()*r+o.getMinutes(),l=a.isInteger(e);return s-=s%i,n=0>e&&-i>=i*e+s,s+="min"==t&&n?0:i,l&&(s+=i*(n&&"max"!=t?e+1:e)),s},n.prototype.normalize=function(t,e){var n=this.item.interval,i=this.item.min&&this.item.min.pick||0;return e-="min"==t?0:(e-i)%n},n.prototype.measure=function(t,n,o){var s=this;return n||(n="min"==t?[0,0]:[i-1,r-1]),"string"==typeof n?n=s.parse(t,n):n===!0||a.isInteger(n)?n=s.now(t,n,o):e.isPlainObject(n)&&a.isInteger(n.pick)&&(n=s.normalize(t,n.pick,o)),n},n.prototype.validate=function(t,e,n){var i=this,r=n&&n.interval?n.interval:i.item.interval;return i.disabled(e)&&(e=i.shift(e,r)),e=i.scope(e),i.disabled(e)&&(e=i.shift(e,-1*r)),e},n.prototype.disabled=function(t){var n=this,i=n.item.disable.filter(function(i){return a.isInteger(i)?t.hour==i:e.isArray(i)||a.isDate(i)?t.pick==n.create(i).pick:e.isPlainObject(i)?n.withinRange(i,t):void 0});return i=i.length&&!i.filter(function(t){return e.isArray(t)&&"inverted"==t[2]||e.isPlainObject(t)&&t.inverted}).length,-1===n.item.enable?!i:i||t.pick<n.item.min.pick||t.pick>n.item.max.pick},n.prototype.shift=function(t,e){var n=this,i=n.item.min.pick,r=n.item.max.pick;for(e=e||n.item.interval;n.disabled(t)&&(t=n.create(t.pick+=e),!(t.pick<=i||t.pick>=r)););return t},n.prototype.scope=function(t){var e=this.item.min.pick,n=this.item.max.pick;return this.create(t.pick>n?n:t.pick<e?e:t)},n.prototype.parse=function(t,e,n){var i,o,s,l,c,u=this,h={};if(!e||"string"!=typeof e)return e;n&&n.format||(n=n||{},n.format=u.settings.format),u.formats.toArray(n.format).map(function(t){var n,i=u.formats[t],r=i?a.trigger(i,u,[e,h]):t.replace(/^!/,"").length;i&&(n=e.substr(0,r),h[t]=n.match(/^\d+$/)?+n:n),e=e.substr(r)});for(l in h)c=h[l],a.isInteger(c)?l.match(/^(h|hh)$/i)?(i=c,("h"==l||"hh"==l)&&(i%=12)):"i"==l&&(o=c):l.match(/^a$/i)&&c.match(/^p/i)&&("h"in h||"hh"in h)&&(s=!0);return(s?i+12:i)*r+o},n.prototype.formats={h:function(t,e){return t?a.digits(t):e.hour%o||o},hh:function(t,e){return t?2:a.lead(e.hour%o||o)},H:function(t,e){return t?a.digits(t):""+e.hour%24},HH:function(t,e){return t?a.digits(t):a.lead(e.hour%24)},i:function(t,e){return t?2:a.lead(e.mins)},a:function(t,e){return t?4:s/2>e.time%s?"a.m.":"p.m."},A:function(t,e){return t?2:s/2>e.time%s?"AM":"PM"},toArray:function(t){return t.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(t,e){var n=this;return n.formats.toArray(t).map(function(t){return a.trigger(n.formats[t],n,[0,e])||t.replace(/^!/,"")}).join("")}},n.prototype.isTimeExact=function(t,n){var i=this;return a.isInteger(t)&&a.isInteger(n)||"boolean"==typeof t&&"boolean"==typeof n?t===n:(a.isDate(t)||e.isArray(t))&&(a.isDate(n)||e.isArray(n))?i.create(t).pick===i.create(n).pick:e.isPlainObject(t)&&e.isPlainObject(n)?i.isTimeExact(t.from,n.from)&&i.isTimeExact(t.to,n.to):!1},n.prototype.isTimeOverlap=function(t,n){var i=this;return a.isInteger(t)&&(a.isDate(n)||e.isArray(n))?t===i.create(n).hour:a.isInteger(n)&&(a.isDate(t)||e.isArray(t))?n===i.create(t).hour:e.isPlainObject(t)&&e.isPlainObject(n)?i.overlapRanges(t,n):!1},n.prototype.flipEnable=function(t){var e=this.item;e.enable=t||(-1==e.enable?1:-1)},n.prototype.deactivate=function(t,n){var i=this,r=i.item.disable.slice(0);return"flip"==n?i.flipEnable():n===!1?(i.flipEnable(1),r=[]):n===!0?(i.flipEnable(-1),r=[]):n.map(function(t){for(var n,o=0;o<r.length;o+=1)if(i.isTimeExact(t,r[o])){n=!0;break}n||(a.isInteger(t)||a.isDate(t)||e.isArray(t)||e.isPlainObject(t)&&t.from&&t.to)&&r.push(t)}),r},n.prototype.activate=function(t,n){var i=this,r=i.item.disable,o=r.length;return"flip"==n?i.flipEnable():n===!0?(i.flipEnable(1),r=[]):n===!1?(i.flipEnable(-1),r=[]):n.map(function(t){var n,s,l,c;for(l=0;o>l;l+=1){if(s=r[l],i.isTimeExact(s,t)){n=r[l]=null,c=!0;break}if(i.isTimeOverlap(s,t)){e.isPlainObject(t)?(t.inverted=!0,n=t):e.isArray(t)?(n=t,n[2]||n.push("inverted")):a.isDate(t)&&(n=[t.getFullYear(),t.getMonth(),t.getDate(),"inverted"]);break}}if(n)for(l=0;o>l;l+=1)if(i.isTimeExact(r[l],t)){r[l]=null;break}if(c)for(l=0;o>l;l+=1)if(i.isTimeOverlap(r[l],t)){r[l]=null;break}n&&r.push(n)}),r.filter(function(t){return null!=t})},n.prototype.i=function(t,e){return a.isInteger(e)&&e>0?e:this.item.interval},n.prototype.nodes=function(t){var e=this,n=e.settings,i=e.item.select,r=e.item.highlight,o=e.item.view,s=e.item.disable;return a.node("ul",a.group({min:e.item.min.pick,max:e.item.max.pick,i:e.item.interval,node:"li",item:function(t){t=e.create(t);var l=t.pick,c=i&&i.pick==l,u=r&&r.pick==l,h=s&&e.disabled(t),d=a.trigger(e.formats.toString,e,[n.format,t]);return[a.trigger(e.formats.toString,e,[a.trigger(n.formatLabel,e,[t])||n.format,t]),function(t){return c&&t.push(n.klass.selected),u&&t.push(n.klass.highlighted),o&&o.pick==l&&t.push(n.klass.viewset),h&&t.push(n.klass.disabled),t.join(" ")}([n.klass.listItem]),"data-pick="+t.pick+" "+a.ariaAttr({role:"option",label:d,selected:c&&e.$node.val()===d?!0:null,activedescendant:u?!0:null,disabled:h?!0:null})]}})+a.node("li",a.node("button",n.clear,n.klass.buttonClear,"type=button data-clear=1"+(t?"":" disabled")+" "+a.ariaAttr({controls:e.$node[0].id})),"",a.ariaAttr({role:"presentation"})),n.klass.list,a.ariaAttr({role:"listbox",controls:e.$node[0].id}))},n.defaults=function(t){return{clear:"Clear",format:"h:i A",interval:30,closeOnSelect:!0,closeOnClear:!0,klass:{picker:t+" "+t+"--time",holder:t+"__holder",list:t+"__list",listItem:t+"__list-item",disabled:t+"__list-item--disabled",selected:t+"__list-item--selected",highlighted:t+"__list-item--highlighted",viewset:t+"__list-item--viewset",now:t+"__list-item--now",buttonClear:t+"__button--clear"}}}(t.klasses().picker),t.extend("pickatime",n)});